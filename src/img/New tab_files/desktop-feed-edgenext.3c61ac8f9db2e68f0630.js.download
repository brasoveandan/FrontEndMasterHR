(window.webpackJsonp=window.webpackJsonp||[]).push([["desktop-feed-edgenext"],{"2H+z":function(e,t,i){"use strict";var s=i("yvDU"),n=i("rkDk"),a=i("wh7w"),r=i("btVS"),o=i("SEb4");t.a=function(e,t,i){var d=Object(o.a)(e)?s.a:r.a,c=arguments.length<3;return d(e,Object(a.a)(t,4),i,c,n.a)}},"5xIM":function(e,t,i){var s,n,a;n=[t,e],void 0===(a="function"==typeof(s=function(e,t){"use strict";var i=5e3,s="callback";function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function a(e){try{delete window[e]}catch(t){window[e]=void 0}}function r(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}t.exports=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,d=t.timeout||i,c=t.jsonpCallback||s,l=void 0;return new Promise((function(i,s){var u=t.jsonpCallbackFunction||n(),h=c+"_"+u;window[u]=function(e){i({ok:!0,json:function(){return Promise.resolve(e)}}),l&&clearTimeout(l),r(h),a(u)},o+=-1===o.indexOf("?")?"?":"&";var p=document.createElement("script");p.setAttribute("src",""+o+c+"="+u),t.charset&&p.setAttribute("charset",t.charset),p.id=h,document.getElementsByTagName("head")[0].appendChild(p),l=setTimeout((function(){s(new Error("JSONP request to "+e+" timed out")),a(u),r(h),window[u]=function(){a(u)}}),d),p.onerror=function(){s(new Error("JSONP request to "+e+" failed")),a(u),r(h),l&&clearTimeout(l)}}))}})?s.apply(t,n):s)||(e.exports=a)},"7oW3":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var s=i("G82u");class n{}function a(){n.updateLocationDisplayName.unregisterObservers(),n.fetchWeatherSummarySuccess.unregisterObservers(),n.updateLocationDetectionState.unregisterObservers(),n.updateWeatherUserProfile.unregisterObservers(),n.updateCurrentLocation.unregisterObservers(),n.updateWeatherSettings.unregisterObservers(),n.updateNonmapComponmentsReadiness.unregisterObservers(),n.updateOperationFailure.unregisterObservers()}n.updateLocationDisplayName=new s.a("UpdateLocationDisplayName"),n.fetchWeatherSummarySuccess=new s.a("FetchWeatherSummarySuccess"),n.updateLocationDetectionState=new s.a("UpdateLocationDetectionState"),n.updateWeatherUserProfile=new s.a("UpdateWeatherUserProfile"),n.updateCurrentLocation=new s.a("UpdateCurrentLocation"),n.updateWeatherSettings=new s.a("UpdateWeatherSettings"),n.updateNonmapComponmentsReadiness=new s.a("UpdateNonmapComponmentsReadiness"),n.updateOperationFailure=new s.a("updateOperationFailure")},"8+qV":function(e,t){},"860H":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var s={};i.r(s),i.d(s,"sendContentReaction",(function(){return a}));var n=i("HAaN");const a=(e,t,i,s)=>{i?n.b.resetRating(n.a.contents,e,s):n.b.rate(n.a.contents,e,t,!0,s)}},"8ntK":function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e.Save="Save",e.Mute="Mute",e.Follow="Follow",e.Unfollow="Unfollow",e.InterestFailure="InterestFailure",e.ShowMore="ShowMore",e.ShowFewer="ShowFewer"}(s||(s={}))},AMBy:function(e,t,i){"use strict";function s(e,t){return"function"==typeof IntersectionObserver?new IntersectionObserver(e,t):null}i.d(t,"a",(function(){return s}))},Cj5D:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return c}));var s,n,a=i("C4R5"),r=i("HS3Q"),o=i("+qLX"),d=i("w0HK");function c(e,t){e&&t?Object(a.a)().pushHistory(r.b.Personalize,"",{isRequestFromSdCardAddRemoveClick:!0}):e&&Object(d.a)().switchPivot({pivotId:e.pivotId,configIndexHref:e.configIndexHref,configIndexRef:e.configIndexRef,context:{isRequestFromSdCardAddRemoveClick:!0},telemetryPageName:o.a.Interests,display:e.displayName})}!function(e){e.SwitchToPageSettings="SwitchToPageSettings",e.SwitchToNewsSettingsInPersonalizePivot="SwitchToNewsSettingsInPersonalizePivot"}(s||(s={})),function(e){e.edgePageSettings="EdgePageSettings",e.chromiumPageSettings="ChromiumPageSettings",e.proActiveCanvasSettingHandler="ProActiveCanvasHandler",e.localStorageSettings="LocalStorageSettings"}(n||(n={}))},Cn94:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s,n=i("G82u");!function(e){e.SaveCard="SaveCard",e.UnsaveCard="UnsaveCard",e.HideCard="HideCard",e.UnhideCard="UnhideCard"}(s||(s={}));class a{}a.Init=new n.a("Init"),a.DisableMenu=new n.a("DisableMenu")},FfXy:function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e[e.none=0]="none",e[e.enabled=1]="enabled",e[e.saved=2]="saved",e[e.hide=4]="hide",e[e.showMore=8]="showMore",e[e.showFewer=16]="showFewer",e[e.mute=32]="mute",e[e.hidden=64]="hidden",e[e.report=128]="report",e[e.adFeedbackSubmitted=256]="adFeedbackSubmitted"}(s||(s={}))},HcI6:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var s=i("D57K"),n=i("/FrS"),a=i("u8F0"),r=i("CgWR"),o=i("hSGL"),d=i("XlyT"),c=i("HxRh"),l=i("I6Lx"),u=i("xYH4"),h=i("X9Vi");function p(e){return!!e&&"null"!==e&&"undefined"!==e&&"false"!==e}function g(e,t){return new Date(t.updatedDateTime).valueOf()-new Date(e.updatedDateTime).valueOf()}class m{constructor(){this.PdpDefaultLocation="DefaultLocation",this.PdpFavoriteLocation="FavoriteLocation",this.instance=o.a}read(){return Object(s.b)(this,void 0,void 0,(function*(){let e=null;try{const t=yield this.instance.readPdpWithTargetType(a.a.Location),{value:i=[]}=t||{value:[]};e=this.convertPdpDataToPdpResponse(i)}catch(e){Object(d.c)(e,c.Bh,"Weather PDP Read Failed")}if(!e)try{const t=yield this.instance.getPdpUserPreference(),{value:i=[]}=t||{value:[]};e=this.parseUserProfileFromPdpData(i)}catch(e){Object(d.c)(e,c.Bh,"Weather PDP User Read Failed")}return e||{}}))}setDisplayUnit(e){return Object(s.b)(this,void 0,void 0,(function*(){let t=!1;try{t=yield this.instance.updatePdpDisplayUnit(e.toString())}catch(e){Object(d.c)(e,c.zh,"Display unit Update failed"),t=!1}return t}))}updateUserSettings(e,t,i){return Object(s.b)(this,void 0,void 0,(function*(){let s=!1;try{s=yield this.instance.updateWeatherSettings(e,t,i)}catch(e){Object(d.c)(e,c.Ch,"Weather user settings update failed"),s=!1}return s}))}disableWeatherCard(){return Object(s.b)(this,void 0,void 0,(function*(){let e=!1;try{e=yield this.instance.updateSegmentCardsEnableStatus([{cardType:r.a.WeatherCard,enabled:!1}])}catch(t){Object(d.c)(t,c.Ch,"Disable weather segment card failed"),e=!1}return e}))}setHomeLocation(e,t){return Object(s.b)(this,void 0,void 0,(function*(){let i=!1;try{i=yield this.instance.updatePdpHomeLocation(m.buildMetaData(e),`${e.latitude},${e.longitude}`,t)}catch(e){Object(d.c)(e,c.Ah,"Home Location Update Failed"),i=!1}return i}))}addFavoriteLocation(e){return Object(s.b)(this,void 0,void 0,(function*(){const t=`${e.latitude},${e.longitude}`;return yield this.instance.addToFavoriteLocation(m.buildMetaData(e),t)}))}removeFavoriteLocation(e){return Object(s.b)(this,void 0,void 0,(function*(){const t=e.definitionName||`${e.latitude},${e.longitude}`,i=yield this.instance.removeFavoriteLocation(t);return i&&(e.definitionName=null),i}))}convertPdpDataToPdpResponse(e){if(e&&e[0]){const t=e.filter(e=>e.degree===this.PdpDefaultLocation).sort(g)[0],i=m.parseLocationFromPdpValue(t);return i&&(i.from=n.e.HomeFromPdp,i.displayName=h.b.getDisplayName(i)),Object.assign(Object.assign({},m.parseUnitAndMode(t)),{home:i,favorites:e.filter(e=>e.degree===this.PdpFavoriteLocation).map(m.parseLocationFromPdpValue).filter(e=>!!e),recents:void 0})}return null}parseUserProfileFromPdpData(e){if(e&&e[0]){const t=e.find(e=>e.weatherDisplayUnit);if(!(t&&(t.weatherDisplayUnit||t.userSettings&&t.userSettings.weatherLocationSettingMode)))return null;let i=void 0;t.weatherDisplayUnit&&(i="2"===t.weatherDisplayUnit?n.g.Celsius:n.g.Fahrenheit);let s=void 0;return t.userSettings&&t.userSettings.weatherLocationSettingMode&&(s="2"===t.userPreference.userSettings.weatherLocationSettingMode?n.a.SpecifyLocation:n.a.DetectCurrentLocation),{home:void 0,unit:i,locationMode:s,favorites:void 0,recents:void 0}}return null}static buildMetaData(e){const t=e.language||l.b.Locale||"";return JSON.parse(JSON.stringify({geoCoordinates:{latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude)},addressLine:e.addressLine,subRegion:e.subRegion,readLink:e.readLink,city:e.locality,state:e.region,countryRegion:e.country,postalCode:e.postalCode,isoCode:e.isoCode,locationType:"number"==typeof e.locationType?e.locationType||1:Object(u.a)(""+e.locationType,1),locationTypeId:[e.locality,e.region,e.country].filter(e=>!!e).join(","),language:t||void 0}))}static parseUnitAndMode(e){let t=0,i=0;return e&&e.metadata&&("2"!==e.metadata.displayunit&&"1"!==e.metadata.displayunit||(t="2"===e.metadata.displayunit?n.g.Celsius:n.g.Fahrenheit),"1"!==e.metadata.locationSettingMode&&"2"!==e.metadata.locationSettingMode||(i="1"===e.metadata.locationSettingMode?n.a.DetectCurrentLocation:n.a.SpecifyLocation)),{unit:t,locationMode:i}}static parseLocationFromPdpValue(e){let t=null;if(e&&e.definitionName&&e.metadata){t={latitude:e.definitionName.split(",")[0],longitude:e.definitionName.split(",")[1],addressLine:p(e.metadata.addressLine)?e.metadata.addressLine:void 0,locality:p(e.metadata.city)?e.metadata.city:void 0,subRegion:p(e.metadata.subRegion)?e.metadata.subRegion:void 0,region:p(e.metadata.state)?e.metadata.state:void 0,country:p(e.metadata.countryRegion)?e.metadata.countryRegion:void 0,displayName:"",isoCode:p(e.metadata.isoCode)?e.metadata.isoCode:void 0,locationTypeId:e.metadata.locationTypeId,postalCode:e.metadata.postalCode,language:(e.metadata.language||h.b.extractLanguageTag(e.metadata.locationTypeId)||l.b.Locale).toLocaleLowerCase(),definitionName:e.definitionName,readLink:p(e.metadata.readLink)?e.metadata.readLink:void 0},t.region=h.d.abbreviateUSState(t.region,t.language,t.isoCode),t.locationType=1,"number"!=typeof e.metadata.locationType&&void 0!==e.metadata.locationType||(t.locationType=e.metadata.locationType||1),"string"==typeof e.metadata.locationType&&p(e.metadata.locationType)&&(t.locationType=Object(u.a)(""+e.metadata.locationType,1));const i=e.metadata.geoCoordinates;!i||0===i.latitude&&0===i.longitude||(t.latitude=""+i.latitude,t.longitude=""+i.longitude),t.addressLine||t.locality||t.region||(t=null),t&&!h.b.isValid(t)&&(t=null),t&&"0"===t.latitude&&"0"===t.longitude&&(e.metadata.name||e.metadata.countryRegion||e.metadata.city||e.metadata.state||(t=null))}return t}}},JFdr:function(e,t,i){"use strict";var s=Math.floor,n=Math.random;t.a=function(e,t){return e+s(n()*(t-e+1))}},KPQt:function(e,t,i){"use strict";var s=i("XAMW"),n=i("b8Mt"),a=i("wh7w");t.a=function(e,t){return Object(s.a)(e,Object(a.a)(t,3),n.a)}},KmUD:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a})),i.d(t,"e",(function(){return p})),i.d(t,"f",(function(){return g})),i.d(t,"c",(function(){return m})),i.d(t,"d",(function(){return b})),i.d(t,"k",(function(){return v})),i.d(t,"g",(function(){return f})),i.d(t,"j",(function(){return y})),i.d(t,"i",(function(){return S})),i.d(t,"h",(function(){return C}));var s,n,a,r=i("YJhp"),o=i("Am8i"),d=i("dMmp"),c=i("uZl+"),l=i("kpPY"),u=i("XgsJ"),h=i("vhqU");!function(e){e.Email="email",e.Facebook="facebook",e.Line="line",e.LinkedIn="linkedin",e.Skype="skype",e.Twitter="twitter",e.VK="vk",e.WhatsApp="whatsapp"}(s||(s={})),function(e){e.Share="share",e.Mute="mute",e.Report="report",e.ReportAd="reportad"}(n||(n={})),function(e){e.Hide="Hide",e.Like="Like",e.Dislike="Dislike",e.Mute="Mute",e.Save="Save",e.Share="Share",e.ShowMore="ShowMore",e.ShowFewer="ShowFewer",e.Divider="Divider",e.Report="Report",e.ReportAd="ReportAd",e.AdPrivacy="AdPrivacy"}(a||(a={}));const p=e=>({[a.Save]:{title:e.localizedStrings.cardActionMenuItemSave,glyph:r.b.Save,undoGlyph:r.a.Saved,onClickPropKey:a.Save,undoText:e.localizedStrings.cardActionMenuItemUndoSave,key:a.Save,telemetryName:c.b.saveMenuItemTelemetryName,telemetryBehavior:o.b.Save,telemetryType:o.e.ActionButton,undoTelemetryType:o.e.ActionButton},[a.Share]:{title:e.localizedStrings.cardActionMenuItemShare,glyph:r.b.Share,onClickPropKey:a.Save,key:a.Share,telemetryName:c.b.shareDialogTelemetryName,telemetryBehavior:o.b.Share,telemetryType:o.e.ActionButton},[a.ShowMore]:{title:e.localizedStrings.cardActionMenuItemShowMore,glyph:r.b.ThumbUp,undoGlyph:r.b.ThumbUpBlue,onClickPropKey:a.ShowMore,undoText:e.localizedStrings.cardActionMenuItemUndoShowMore,key:a.ShowMore,telemetryName:c.b.showMoreMenuItemTelemetryName,telemetryBehavior:o.b.Like,telemetryType:o.e.ActionButton,telemetryContentHeadline:c.b.showMoreHeadlineTelemetryName,undoTelemetryType:o.e.ActionButton},[a.ShowFewer]:{title:e.localizedStrings.cardActionMenuItemShowFewer,glyph:r.b.ThumbDown,undoGlyph:r.b.ThumbDownBlue,onClickPropKey:a.ShowFewer,undoText:e.localizedStrings.cardActionMenuItemUndoShowFewer,key:a.ShowFewer,telemetryName:c.b.showFewerMenuItemTelemetryName,telemetryBehavior:o.b.Dislike,telemetryType:o.e.ActionButton,telemetryContentHeadline:c.b.showFewerHeadlineTelemetryName,undoTelemetryType:o.e.ActionButton},[a.Hide]:{title:e.localizedStrings.cardActionMenuItemHide,glyph:r.b.HideStory,onClickPropKey:a.Save,key:a.Hide,telemetryName:c.b.hideMenuItemTelemetryName,telemetryBehavior:o.b.Hide,telemetryType:o.b.Hide,telemetryContentHeadline:c.b.hideHeadlineTelemetryName},[a.Mute]:{title:e.localizedStrings.cardActionMenuItemMute,glyph:r.b.Hide,onClickPropKey:a.Save,key:a.Mute,telemetryName:c.b.muteMenuItemTelemetryName,telemetryBehavior:o.b.Mute,telemetryType:o.b.Mute},[a.Report]:{title:e.localizedStrings.cardActionMenuItemReport,glyph:r.b.Flag,onClickPropKey:a.Report,key:a.Report,telemetryName:c.b.reportMenuItemTelemetryName,telemetryBehavior:o.b.Report,telemetryType:o.e.ActionButton,telemetryContentHeadline:c.b.reportHeadlineTelemetryName},[a.ReportAd]:{title:e.localizedStrings.cardActionMenuItemReportAd,glyph:r.b.Flag,onClickPropKey:a.ReportAd,key:a.ReportAd}}),g=(e,t,i,n)=>({[s.Email]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaEmailAriaLabel,e.localizedStrings.socialMediaEmailLabel),backgroundColor:"#0078D7",image:{alt:e.localizedStrings.socialMediaEmailLabel,src:r.a.Mail},source:e.localizedStrings.socialMediaEmailLabel,target:"_self",href:d.String.Format("mailto:?subject={title}&body={body}",{title:encodeURIComponent(i),body:encodeURIComponent(Object(l.a)(e.localizedStrings.shareDialogEmailBodyText,i,t))}),telemetryTag:n&&n[s.Email]},[s.Facebook]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"Facebook"),backgroundColor:"#4267B2",image:{alt:"Facebook",src:r.a.Facebook},source:"Facebook",target:"_blank",href:d.String.Format("https://www.facebook.com/sharer.php?u={url}&amp;t={title}",{url:encodeURIComponent(t),title:encodeURIComponent(i)}),telemetryTag:n&&n[s.Facebook]},[s.LinkedIn]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"LinkedIn"),backgroundColor:"#0083BE",image:{alt:"LinkedIn",src:r.a.LinkedIn},source:"LinkedIn",target:"_blank",href:d.String.Format("https://www.linkedin.com/shareArticle?mini=true&url={url}&title={title}&source={refererUrl}",{url:encodeURIComponent(t),title:encodeURIComponent(i),refererUrl:Object(u.k)()}),telemetryTag:n&&n[s.LinkedIn]},[s.Skype]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"Skype"),backgroundColor:"#33BFFC",image:{alt:"Skype",src:r.a.Skype},source:"Skype",target:"_blank",href:d.String.Format("https://web.skype.com/share?url={url}&flow_id={flowid}&source=msn",{url:encodeURIComponent(t),flowid:Object(h.a)()}),telemetryTag:n&&n[s.Skype]},[s.Twitter]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"Twitter"),backgroundColor:"#20A2F2",image:{alt:"Twitter",src:r.a.Twitter},source:"Twitter",target:"_blank",href:d.String.Format("https://twitter.com/share?url={url}&text={title}&original_referer={refererUrl}",{url:encodeURIComponent(t),title:encodeURIComponent(i),refererUrl:Object(u.k)()}),telemetryTag:n&&n[s.Twitter]},[s.WhatsApp]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"WhatsApp"),backgroundColor:"#25D366",image:{alt:"WhatsApp",src:r.a.WhatsApp},source:"WhatsApp",target:"_blank",href:d.String.Format("https://web.whatsapp.com/send?text={url}",{url:encodeURIComponent(t)}),telemetryTag:n&&n[s.WhatsApp]}}),m={personalize:"Personalize",myInterests:"MyInterests"},b=5e3,v="/{locale}/feed/personalize#mutedPublishers",f="{locale}",y="https://www.msn.com",S="https://go.microsoft.com/fwlink/?LinkId=521839",C="https://petrol.office.microsoft.com/v1/feedback"},Qo3E:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));class s{static renderToast(e){this.renderToastCallback&&this.renderToastCallback(e)}static setRenderToastCallback(e){this.renderToastCallback=e}static expireToast(e){this.expireToastCallback&&this.expireToastCallback(e)}static setExpireToastCallback(e){this.expireToastCallback=e}static setCurrentToast(e,t){this.currentToastId!==e&&(this.currentToastId=e,this.renderToastCallback=t,this.currentToastIdChangeCallbacks.forEach(t=>t(e)),this.renderToast())}static addCurrentToastIdChangeCallback(e){e&&this.currentToastIdChangeCallbacks.push(e)}}s.currentToastIdChangeCallbacks=[]},XAMW:function(e,t,i){"use strict";t.a=function(e,t,i){var s;return i(e,(function(e,i,n){if(t(e,i,n))return s=i,!1})),s}},bYbF:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var s,n=i("D57K"),a=i("KmUD"),r=i("I6Lx"),o=i("rvYQ"),d=i("1I/+"),c=i("6ADy"),l=i("msIb"),u=i("KETb"),h=i("k112"),p=i("KUTD"),g=i("Qo3E"),m=i("8ntK"),b=i("HxRh"),v=i("XlyT"),f=i("FfXy"),y=i("ypwz"),S=i("tERu"),C=i("u5KZ"),O=i("r6MD"),A=i("/+Un"),w=i("hxZq"),I=i("4L2h");!function(e){e[e.feedbackDefault=2224]="feedbackDefault",e[e.windowsFeed=2475]="windowsFeed"}(s||(s={}));class j{constructor(){this.manifestType="Sas",this.appId=s.feedbackDefault,this.source="Client",this.type="Idea"}}class T{constructor(e){this.fetchImpl=e,this.providersServiceEndpoint="./Msn/Providers",this.cardActionV2sServiceEndpoint="./Graph/Actions",this.userFeedbackEventhubUrl="/labs/api/feedbackSignal",this.ocid="feeds"}ShowFewer(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Dislike,null)}))}UnshowFewer(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Dislike)}))}ShowMore(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Like)}))}UnshowMore(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Like)}))}Save(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Save)}))}Unsave(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Save)}))}Hide(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Dislike,null)}))}Unhide(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Dislike)}))}Mute(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Mute,"SourceProvider")}))}Report(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){const n=r.b.ClientSettings?r.b.ClientSettings.aid:"";let a="";const d={serviceType:"oneservice",oneServiceTraceId:"",oneServiceActivityId:n};o.b.AppType===y.a.Windows&&(a=C.a.getPageMetadata().JoinIdProps.IDXId,d.oneServiceTraceId="",d.oneServiceActivityId=n),C.a.sendTraceInfoEvent(d);const u=this.createOcvFeedbackData(e,t,i,s);this.reportFeedbackToOcv(u);const h=JSON.stringify({article:{id:e},canvas:{name:o.b.AppType,version:navigator.userAgent,pageType:r.b.ClientSettings.pagetype},data:{feedbackTags:t,feedbackText:i},appEnvironment:o.b,clientSettings:r.b.ClientSettings,extSchema:d}),p=Object(c.c)().origin+this.userFeedbackEventhubUrl,g={method:"POST",headers:yield l.a.getOneServiceHeaders(),body:h,credentials:"include"};let m;try{if(m=yield fetch(p,g),m.status>=400)throw new Error(m.statusText)}catch(e){C.a.sendAppErrorEvent(Object.assign(Object.assign({},b.R.CardActionPostActionError),{message:"Error while posting action for card action",pb:Object.assign(Object.assign({},b.R.CardActionPostActionError.pb),{customMessage:`url: ${p}, error: ${e}`})}))}return m}))}reportFeedbackToOcv(e){return Object(n.b)(this,void 0,void 0,(function*(){const t={method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};try{const e=yield this.fetchImpl(a.h,t);if(!e.ok){const i=`Error code: ${e.status} Error message: ${e.statusText} Request params: ${t} Service url: ${a.h}`;return Object(v.b)(b.R.CardActionBadRequestReportingToOcv,"Request is not valid, it has no content, or the manifest is not formatted correctly",i),!1}return!0}catch(e){const i=`Error code: ${e?e.code:"undefined"} Error message: ${e?e.message:"undefined"} Request params: ${t} Service url: ${a.h}`;return Object(v.c)(e,b.R.CardActionExceptionReportingToOcv,"Exception reporting feedback to OCV",i),!1}}))}createOcvFeedbackData(e,t,i,n){var a,c,l,u;const h=new j,p=null===r.b||void 0===r.b?void 0:r.b.ClientSettings,g=null===o.b||void 0===o.b?void 0:o.b.HostPage,m=Object(d.b)(n.data.locationHref,"locationHref"),b=(null==p?void 0:p.aid)||"",v=(null===(c=null===(a=null===o.b||void 0===o.b?void 0:o.b.CurrentRequestTargetScope)||void 0===a?void 0:a.pageExperiments)||void 0===c?void 0:c.join(","))||"",f=null===(l=null===o.b||void 0===o.b?void 0:o.b.CurrentRequestTargetScope)||void 0===l?void 0:l.browser;return o.b.AppType!==y.a.Windows&&o.b.AppType!==y.a.WindowsShell||(h.appId=s.windowsFeed),h.submitTime=(new Date).toISOString(),h.clientFeedbackId=Object(I.e)(),h.comment=i,h.rating=4,h.application={appData:`{"ScreenResolution":"${window&&window.screen?[screen.width,screen.height].join("x"):""}","articleId":"${e}"}`},h.telemetry={audience:(null===o.b||void 0===o.b?void 0:o.b.CurrentMarket)||"",audienceGroup:(null==g?void 0:g.verticalKey)||"Production",channel:(null==g?void 0:g.categoryKey)||"",deviceType:(null==p?void 0:p.deviceFormFactor)||"",errorClassification:JSON.stringify({articleId:e,NotRelevant:t.OffensiveOrAdult,BlurryImage:t.InaccurateOrMisleading,OutdatedArticle:t.Duplicate,MisleadingTitle:t.Outdated,DuplicateArticle:t.DisplayIssue,OffensiveContent:t.Other}),featureArea:(null==p?void 0:p.pagetype)||"",flights:v,isUserSubscriber:Object(A.e)(),platform:null===(u=o.b.CurrentRequestTargetScope)||void 0===u?void 0:u.os,processSessionId:b,sourceContext:o.b.AppType},h.web={browser:(null==f?void 0:f.browserType)||"",browserVersion:(null==f?void 0:f.version)||"",sourcePageName:(null==g?void 0:g.subcategoryKey)||"",sourcePageURI:m},h}ReportAd(e,t){return Object(n.b)(this,void 0,void 0,(function*(){const i=e.concat("&f="+t);let s=new Image(1,1);s.src=i,s=null}))}GetProviderIcon(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield this.GetPublisherDetails(e);return Object(O.a)(t,"value[0].logos[0].imageLink.href",void 0)}))}PostCardActionV2Event(e,t,i,s=(()=>null),r,o,d=!0,c){return Object(n.b)(this,void 0,void 0,(function*(){switch(t){case a.a.ShowMore:return e&f.a.showMore?(d&&g.a.renderToast({id:m.a.ShowMore+"-"+i,toastType:m.a.ShowMore,expirationInMs:a.d,onClick:()=>{r?r(i,e^f.a.showMore,t,!0):this.PostCardActionV2Event(e^f.a.showMore,t,i,s)},referrerButton:c}),yield this.ShowMore(i)):(g.a.expireToast(m.a.ShowMore+"-"+i),yield this.UnshowMore(i)),s(i,e);case a.a.ShowFewer:return e&f.a.showFewer?(d&&g.a.renderToast({id:m.a.ShowFewer+"-"+i,toastType:m.a.ShowFewer,expirationInMs:a.d,onClick:()=>{r?r(i,e^f.a.showFewer,t,!0):this.PostCardActionV2Event(e^f.a.showFewer,t,i,s)},referrerButton:c}),yield this.ShowFewer(i)):(g.a.expireToast(m.a.ShowFewer+"-"+i),yield this.UnshowFewer(i)),s(i,e);case a.a.Save:return e&f.a.saved?(d&&g.a.renderToast({id:m.a.Save+"-"+i,toastType:m.a.Save,expirationInMs:a.d,referrerButton:c}),yield this.Save(i)):(g.a.expireToast(m.a.Save+"-"+i),yield this.Unsave(i)),s(i,e);case a.a.Hide:return e&f.a.hide?yield this.Hide(i):yield this.Unhide(i),s(i,e);case a.a.Mute:yield this.Mute(o);break;case a.a.ReportAd:return s(i,e);default:return}}))}GetPublisherDetails(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield l.a.getBaseRequestData("GET"),i={key:"ids",value:e},s=Object(c.d)(this.providersServiceEndpoint);[i,...yield this.getOneServiceCommonParam()].forEach(e=>e.value&&s.searchParams.set(e.key,e.value));try{const i=yield Object(u.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(s.href,t)})),"getProviderDetails");if(!i.ok){const t=`OneService returned error response. Status: ${i.status} for providerId: ${e} (url: ${s.href}`;throw new Error(t)}return i.json()}catch(e){C.a.sendAppErrorEvent(Object.assign(Object.assign({},b.R.CardActionGetActionError),{message:`Error while calling getPublisherDetails action for card action: url: ${s.href}, error: ${e}`}))}}))}DeleteCardActionV2Request(e,t){return Object(n.b)(this,void 0,void 0,(function*(){const i=yield l.a.getBaseRequestData("DELETE");(yield this.isUserSignedIn())&&(i.credentials="include");const s={key:"$filter",value:`actionType eq '${t}' and targetId eq '${e}'`},a=Object(c.d)(this.cardActionV2sServiceEndpoint);[s,...yield this.getOneServiceCommonParam()].forEach(e=>e.value&&a.searchParams.set(e.key,e.value));try{const s=yield Object(u.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(a.href,i)})),"deleteCardActionV2"+t);if(s.status>=400){const i=`OneService returned error response. Status: ${s.status} for actionType: ${t} and targetId: ${e}`;throw new Error(i)}return Object(h.a)(this.getPreloadReloadReason(t)),Object(w.d)(),s}catch(e){C.a.sendAppErrorEvent(Object.assign(Object.assign({},b.R.CardActionDeleteActionError),{message:`Error while calling delete action for card action: url: ${a.href}, error: ${e}`}))}}))}PostCardActionV2Request(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){const s={method:"POST",body:JSON.stringify({actionType:t,targetId:e,targetType:i}),headers:yield l.a.getOneServiceHeaders()};(yield this.isUserSignedIn())&&(s.credentials="include");const a=Object(c.d)(this.cardActionV2sServiceEndpoint);(yield this.getOneServiceCommonParam()).forEach(e=>e.value&&a.searchParams.set(e.key,e.value));try{const r=yield Object(u.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(a.href,s)})),"getCardActionV2"+t);if(r.status>=400){const s=`OneService returned error response. Status: ${r.status} for actionType: ${t}, targetId: ${e} and targetType: ${i}`;throw new Error(s)}return Object(h.a)(this.getPreloadReloadReason(t)),Object(w.d)(),r.json()}catch(e){C.a.sendAppErrorEvent(Object.assign(Object.assign({},b.R.CardActionPostActionError),{message:`Error while posting action for card action: url: ${a.href}, error: ${e}`}))}}))}getOneServiceCommonParam(){return Object(n.b)(this,void 0,void 0,(function*(){const e=yield this.isUserSignedIn();let t=!0;return o.b.AppType!==y.a.NewsAndInterests&&o.b.AppType!==y.a.WindowsNewsPlus||(t=!1,this.ocid="winp2"),e?l.a.getOneServiceParamsWithAuth(o.b.UserId,this.ocid,t):l.a.getOneServiceParamsWithoutAuth(o.b.UserId,this.ocid,t)}))}isUserSignedIn(){return Object(n.b)(this,void 0,void 0,(function*(){if(r.b.UserIsSignedIn)return!0;return(yield Object(A.d)())===S.c.SignedIn}))}getPreloadReloadReason(e){switch(e){case a.a.Mute:return p.a.MutePublisher;case a.a.Save:return p.a.Save;case a.a.Like:return p.a.Like;case a.a.Dislike:return p.a.Dislike;default:return p.a.SettingsChange}}}},btVS:function(e,t,i){"use strict";t.a=function(e,t,i,s,n){return n(e,(function(e,n,a){i=s?(s=!1,e):t(i,e,n,a)})),i}},cASJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return te})),i.d(t,"b",(function(){return se}));var s,n=i("D57K"),a=i("BhE+"),r=i("XlyT"),o=i("HxRh"),d=i("+djJ"),c=i("YUMq"),l=i("pMIE"),u=i("2H+z"),h=i("r6MD"),p=i("KPQt"),g=i("oIHq"),m=i("rvYQ"),b=i("Fpjf"),v=i("ADRF"),f=i("aHCm");!function(e){e.SlideshowPreview="ss",e.ArticlePreview="ar",e.VideoPreview="vi"}(s||(s={}));var y=i("KETb"),S=i("u5KZ");class C{getCMSList(e,t){return Object(n.b)(this,void 0,void 0,(function*(){if(e)try{const i={method:"GET",headers:{}},s=yield Object(y.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){const t=new URL(`${a.e.CMSListServiceUrl}${e}${m.b.ContentServiceUrlBase.search}`,""+m.b.ContentServiceUrlBase),s=yield fetch(t.toString(),i);if(s.ok)return s.json();S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed",`Invalid response from CMS, ${s.statusText}, listId: ${e}`))})),"getCMSList");if(!s)return void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed","Invalid response.json(), listId: "+e));const d=s;return this.translateToCMSItem(d,e,t,a.b.PrivacyUrl)}catch(t){return void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed",`Error while fetching CMS Native Ad  ${t}, id: ${e}`))}else S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed","No backfill id found, listId: "+e))}))}translateToCMSItem(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.list||0===e.list.length)return void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed","No CMS Response returned from "+t));const n=[];for(const t of e.list){let e=!1;const r=t.extendedProperties;if(r)for(const t of r)if(t.key&&t.key.indexOf("is_content")>-1&&t.values&&t.values.indexOf("true")>-1){e=!0;break}let o;if(null!=t.link&&null!=t.link.title&&t.link.href&&null!=t.link.image&&null!=t.link.image.href){const i=this.getCMSContentId(t.link.image.href);let n,r;if(t.link.ad)if(t.link.ad.providerHref&&t.link.ad.providerHref.href){const e=this.getCMSContentId(t.link.ad.providerHref.href);e?n=yield this.fetchProviderName(e):t.link.ad.sponsorText&&(n=t.link.ad.sponsorText)}else t.link.ad.sponsorText&&(n=t.link.ad.sponsorText);r=n||(null!=t.link.kicker?t.link.kicker:a.e.DefaultProviderName),o={title:t.link.title,url:t.link.href,provider:{name:r},imageUrl:i?Object(b.g)(i,{width:624,height:350,enableDpiScaling:!1}):t.link.image.href,isContent:e,privacyUrl:s}}else if(null!=t.reference&&null!=t.reference.href){const n=this.getCMSContentId(t.reference.href);if(null!=n){const t=yield this.getCMSContent(n);if(!t)continue;o={title:t.title,url:this.constructDestinationUrl(t,i),provider:this.constructProvider(t),imageUrl:this.constructImageUrl(t),isContent:e,privacyUrl:s}}}o&&o.title&&o.imageUrl&&o.url&&n.push(o)}return{id:e._id,items:n}}))}getCMSContent(e){return Object(n.b)(this,void 0,void 0,(function*(){try{const t=new URL(m.b.ContentServiceUrlBase.search,`${m.b.ContentServiceUrlBase}${a.e.CMSContentServiceURl}${e}/`),i=yield fetch(t.toString());if(!i||!i.ok)return void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed","Failed to fetch CMS content, cmsId: "+e));const s=yield i.json();return s||void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed","Invalid JSON response to get CMS content, cmsId: "+e))}catch(t){return void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed",`Error while fetching CMS content ${t}, cmsId: ${e}`))}}))}constructDestinationUrl(e,t){const{category:i}=e,n=i&&i.product||"news",a=i&&i.label||"other",r=s[e.type]||"xx";return`https://www.msn.com/${t}/${v.a.encodeURIComponentForPrime(n||"")}/${v.a.encodeURIComponentForPrime(a||"")}/${v.a.encodeURIComponentForPrime(e.title||"")}/${r}-${e.id}`}constructProvider(e){const{name:t,logo:i}=e.provider;return{name:t,logo:i&&i.id?{src:`${f.a.prod}${i.id}?w=16&h=16`,alt:t}:void 0}}constructImageUrl(e){if(e.images&&!(e.images.length<1)&&e.images[0].id)return Object(b.g)(e.images[0].id,{width:624,height:350,focalRegion:e.images[0].focalRegion,enableDpiScaling:!1})}getCMSContentId(e){return e&&e.indexOf("cms/api/amp")>-1?e.substring(e.lastIndexOf("/")+1):null}fetchProviderName(e){return Object(n.b)(this,void 0,void 0,(function*(){try{const t={method:"GET",headers:{}},i=yield Object(y.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){const i=new URL(`${a.e.CMSListServiceUrl}${e}${m.b.ContentServiceUrlBase.search}`,""+m.b.ContentServiceUrlBase),s=yield fetch(i.toString(),t);if(s.ok)return s.json();S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed",`Invalid response from CMS. status: ${s.status}, statusText: ${s.statusText}, url: ${s.url}`))})),"getProviderName");if(!i)return void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed","Invalid response.json(), cmsId: "+e));const s=i;return s?s.displayName:void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed","Failed to parse JSON response, cmsId: "+e))}catch(t){return void S.a.sendAppErrorEvent(Object(r.a)(o.Fd,"Get CMSAd content failed",`Error while fetching Provider name  ${t}, cmsId: ${e}`))}}))}}var O,A=i("Bwzq");!function(e){e.AR="AR",e.GA="GA",e.VI="VI",e.EDGECHRNTP="edgechrntp",e.EDGECHRDHP="edgechrdhp",e.MSNEWS="msnews",e.FirstParty="firstparty",e.VerticalLandingPage="vlp",e.WINAR="winar",e.WINGA="winga",e.WINVI="winvi"}(O||(O={}));var w=i("hOj1"),I=i("I6Lx"),j=i("y+Kz"),T=i("tWvP"),R=i("ypwz"),M=i("s9+9"),k=i("4wjP"),F=i("KRKw"),D=i("3Amp"),L=i("9J8d");let P,x=!1;const E=new Promise(e=>{P=e});function N(){return Object(n.b)(this,void 0,void 0,(function*(){switch(yield function(){return Object(n.b)(this,void 0,void 0,(function*(){x||(D.a.cookieConsentStatus.registerObserver(e=>{P()}),x=!0);const e=L.a.getInstance().rootReducer.connector(M.a.SharedState),t=e&&e.getCurrentState(),i=t&&t.cookieConsentStatus;return i!==F.b.Unknown?i:(yield E,e.getCurrentState().cookieConsentStatus)}))}()){case F.b.Required:return!0;case F.b.NotRequired:return!1;default:return}}))}class U{updateMsaOptOutCookie(e){if(!this.getMsaOptoutCookieData()&&e&&e.optout){const t=!0===e.optout.msaOptOut?"1":"0";this.setMsaOptoutCookie(t)}}getMsaOptoutCookieData(){const e=Object(w.a)(a.f.MSAOptOut);return e&&e.length>0?e:null}setMsaOptoutCookie(e){e&&e.length>0&&Object(T.a)(a.f.MSAOptOut,e,1,null,"/")}getBrowserOptoutStatus(){const e=Object(w.a)(a.f.BrowserOptOut);return!(!e||"1"!==e)}setUserOptOutSettings(){const e=this.getBrowserOptoutStatus(),t=this.getMsaOptoutCookieData(),i=!(!t||"1"!==t),s=(e||i).toString().toLowerCase();let n="";e&&(n="b|"),i&&(n+="m");const r=a.b.UserOptOut+":"+s+";"+a.b.UserOptOutOptions+":"+n;if(document.head.attributes["data-info"]){const e=document.head.attributes["data-info"].value.split(";");e.find(e=>e.indexOf(a.b.UserOptOut)>-1)?e.find(e=>e.indexOf(a.b.UserOptOut)>-1)!==a.b.UserOptOut+":"+s&&(document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOut+":false",a.b.UserOptOut+":"+s).replace(a.b.UserOptOut+":true",a.b.UserOptOut+":"+s)):document.head.attributes["data-info"].value=document.head.attributes["data-info"].value+";"+a.b.UserOptOut+":"+s,e.find(e=>e.indexOf(a.b.UserOptOutOptions)>-1)?e.find(e=>e.indexOf(a.b.UserOptOutOptions)>-1)!==a.b.UserOptOutOptions+":"+n&&(e.includes(a.b.UserOptOutOptions+":")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":",a.b.UserOptOutOptions+":"+n):e.includes(a.b.UserOptOutOptions+":b|")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":b|",a.b.UserOptOutOptions+":"+n):e.includes(a.b.UserOptOutOptions+":b|m")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":b|m",a.b.UserOptOutOptions+":"+n):e.includes(a.b.UserOptOutOptions+":m")&&(document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":m",a.b.UserOptOutOptions+":"+n))):document.head.attributes["data-info"].value=document.head.attributes["data-info"].value+";"+a.b.UserOptOutOptions+":"+n}else document.head.setAttribute("data-info",r)}}var W=i("HhTf"),B=i("loKy"),H=i("w0HK"),V=i("C4R5");class q{constructor(){this.riverNativeAdCount=0,this.reservedRiverNativeAdCount=0,this.dualWideRiverNativeAdCount=0,this.halfRiverNativeAdCount=0,this.beaconService=new g.a,this.cookieService=new U,this.ecasession=a.b.Ecasession;const e=L.a.getInstance().rootReducer;if(m.b.AppType===R.a.EdgeChromium){const t=e.connector(M.a.ChromiumPageSettings);t&&(this.anaheimPageLayout=t.getCurrentState().currentLayout)}const t=e.connector(M.a.SharedState);t&&t.getCurrentState().useHistory?Object(V.a)().addSwitchListener(this.onPivotSwitch.bind(this),B.a.Monetization):Object(H.a)().addSwitchListener(this.onPivotSwitch.bind(this),B.a.Monetization)}get sourceUrl(){if(this._sourceUrl)return this._sourceUrl;this._sourceUrl=m.b.HostPage.originalUrl;const e=m.b.CurrentRequestTargetScope.pageType,t=m.b.HostPage.verticalKey;if(e&&t){const i=e.toLowerCase();(i.indexOf(k.b.DHP)>-1||i.indexOf(k.b.NTP)>-1)&&(this._sourceUrl="https://"+m.b.HostPage.hostName+"/"+t+"/"+e)}return this._sourceUrl}get pageType(){if(this._pageType)return this._pageType;const e=m.b.CurrentRequestTargetScope.pageType;return this._pageType=e,m.b.AppType===R.a.EdgeChromium?this._pageType=O.EDGECHRNTP:m.b.AppType===R.a.Views&&("article"===e?this._pageType=O.WINAR:"gallery"===e?this._pageType=O.WINGA:"video"===e&&(this._pageType=O.WINVI)),this._pageType}fetchSAMAds(e,t=!1){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||e.placements.length<1)return void S.a.sendAppErrorEvent(Object(r.a)(o.Id,"Invalid request to fetch native ads","No placements found in the request"));const i=e.pageType||this.pageType;if(!i)return void S.a.sendAppErrorEvent(Object(r.a)(o.Id,"Invalid request to fetch native ads","No page type found"));const s=this.getImpressionId(),n=this.cookieService.getBrowserOptoutStatus(),l=yield N(),u=this.getMuid(e.adid),h=this.riverNativeAdCount,p=this.reservedRiverNativeAdCount,g=this.dualWideRiverNativeAdCount,b=this.halfRiverNativeAdCount;!l&&t&&(this.ecasession=Object(w.a)(a.f.TaboolaSessionCookieName)||this.ecasession);const v=!(!I.b.ClientSettings||!I.b.ClientSettings.deviceFormFactor||I.b.ClientSettings.deviceFormFactor!==W.a.Phone),f=this.isNotMyFeed(),y={locale:e.locale,rid:s,partnerId:m.b.CurrentRequestTargetScope.pageType,content:{sourceUrl:this.sourceUrl,pageType:i,previousReservedRiverNativeAdCount:p,previousRiverDualWideNativeAdCount:g,previousRiverHalfNativeAdCount:b,previousRiverNativeAdCount:h,verticalName:m.b.HostPage.verticalKey,anaheimPageLayout:this.anaheimPageLayout,isXfeed:f},user:{muid:u,browserOptOut:n,isAdblock:!1},placements:this.getPlacements(e),extensions:this.getExtensions(this.lastResponseMetadata,this.ecasession),isCookieWallPresent:l,isPeregrine:!0,device:{isMobile:v}},C=JSON.stringify(y),T=new URL(a.b.SamEndpoint);return new Promise(e=>{try{const t=new XMLHttpRequest;t.open(a.j.Method,T.href,!0),t.withCredentials=!0,t.timeout=a.j.Timeout,t.setRequestHeader(a.j.ContentTypeKey,a.j.ContentType),t.setRequestHeader(a.j.FlightIdKey,I.b.CurrentFlights),t.setRequestHeader(a.j.CacheControlKey,a.j.CacheControl),u&&t.setRequestHeader(a.j.ClientIdKey,u),i===O.GA?t.setRequestHeader(a.j.AuthCookieNameKey,a.f.AnonCookieName):Object(w.a)(a.f.AppAnonCookieExist)&&t.setRequestHeader(a.j.AuthCookieNameKey,j.e),t.onload=()=>{e(this.processAdResponse(t))},t.ontimeout=()=>{S.a.sendAppErrorEvent(Object(r.a)(o.Kd,"Timeout calling SAMRTB Ajax",`pageType: ${i}, status: ${t.status}, StatusText: ${t.statusText}`)),e(void 0)},t.onerror=()=>{S.a.sendAppErrorEvent(Object(r.a)(o.Jd,"Error calling SAMRTB Ajax",`pageType: ${i}, status: ${t.status}, StatusText: ${t.statusText}`)),e(void 0)},t.send(C);const s=!0===I.b.IsPrerender?performance.now()-Object(d.g)(c.d):performance.now();Object(d.o)(A.a.TimeToRequestAd,s)}catch(e){return void Object(r.c)(e,o.Ld,"Failed to get response from SAMRTB call","pageType: "+i)}})}))}generateSourceUrl(){const e=m.b.CurrentRequestTargetScope.pageType;let t=m.b.HostPage.originalUrl;const i=m.b.HostPage.verticalKey;if(e&&i){const s=e.toLowerCase();(s.indexOf(k.b.DHP)>-1||s.indexOf(k.b.NTP)>-1)&&(t="https://"+m.b.HostPage.hostName+"/"+i+"/"+e)}return t}processAdResponse(e){if(200!==e.status)return 204===e.status?void S.a.sendAppErrorEvent(Object(r.a)(o.Kd,"No content received from SAMRTB Ajax",`Status: ${e.status}, StatusText: ${e.statusText}`)):void S.a.sendAppErrorEvent(Object(r.a)(o.Jd,"Invalid response from SAMRTB Ajax",`Status: ${e.status}, StatusText: ${e.statusText}`));try{const t=JSON.parse(e.response);if(!t)return void S.a.sendAppErrorEvent(Object(r.a)(o.Md,"Invalid json response from SAMRTB",`Status: ${e.status}, Invalid json: ${e.response}`));const i=t.metaData;return this.processMetaData(i),this.beaconService.fireRequestLevelBeacons(i.requestLevelBeaconUrls),t}catch(t){return void Object(r.c)(t,o.Ld,"Failed to process SAMRTB response",`Status: ${e.status}, json: ${e.response}`)}}getPlacements(e){const t=[];return e.placements.forEach(e=>{if(e.region&&e.indices&&e.indices.length){t.push({region:a.h[e.region]||e.region,indices:e.indices});const i=e.region.toLocaleLowerCase();i===a.b.RiverRegion?this.riverNativeAdCount+=e.indices.length:i===a.b.ReservedRiver?this.reservedRiverNativeAdCount+=e.indices.length:i===a.b.RiverDoubleWide?this.dualWideRiverNativeAdCount+=e.indices.length:i!==a.b.RiverHalf&&i!==a.b.RiverHalfTextOnly||(this.halfRiverNativeAdCount+=e.indices.length)}}),t}processMetaData(e){const t=e&&e.taboola&&e.taboola.sessionId;!this.isCookieWallPresent&&t&&Object(T.a)(a.f.TaboolaSessionCookieName,t,.042,a.f.CookieDomain,"/"),this.lastResponseMetadata=this.mergeMetadata(this.lastResponseMetadata,e),this.cookieService.updateMsaOptOutCookie(e)}mergeMetadata(e,t){return e?t?(t.taboola=this.mergePartnerMetadata(e.taboola,t.taboola),t):e:t}mergePartnerMetadata(e,t){return t=t||{},e&&e.sessionId&&!t.sessionId&&(t.sessionId=e.sessionId),t}getImpressionId(){return this.lastResponseMetadata&&this.lastResponseMetadata.pageViewId?this.lastResponseMetadata.pageViewId:S.a.getRequestId()}clearPreviousInfo(){var e;this.riverNativeAdCount=0,this.reservedRiverNativeAdCount=0,this.dualWideRiverNativeAdCount=0,this.halfRiverNativeAdCount=0,(null===(e=this.lastResponseMetadata)||void 0===e?void 0:e.pageViewId)&&delete this.lastResponseMetadata.pageViewId}getExtensions(e,t){const i={taboola:(e=e||{taboola:{}}).taboola};return i.taboola.sessionId||(i.taboola.sessionId=t),i}getMuid(e){return this.isCookieWallPresent?null:e||Object(w.b)()}onPivotSwitch(e){if(!e.oldSelection)return;const t=e.newSelection.pivotId;t&&t.toLowerCase()!==a.i.EditInterestPivotId&&(this.pivotId=t)}isNotMyFeed(){return!!this.pivotId&&this.pivotId.toLowerCase()!==a.i.MyFeedPivotId&&this.pivotId.toLowerCase()!==a.i.StripeMyFeedPivotId}}var _=i("Tc2z"),$=i("hV4J"),G=i("hqLi"),z=i("SEb4"),Q=i("mEtE"),J=i("zFYL");const K={rating:3,likes:4,price:6,salePrice:7,installmentPrice:500,priceDrop:501,freeShipping:502,viewed:503,sold:504,specialOffer:505,eliteBadge:506,condition:507,localInventory:508,curbsidePickup:509,review:510};class X{}X.concat=(e,t)=>`${e}.${t}`,X.identity=e=>t=>X.concat(e,t),X.boolean=e=>t=>t?X.concat(e,"1"):null;class Z{constructor(){this._availableAssets="",this._displayedAssets=""}get availableAssets(){return this._availableAssets}get displayedAssets(){return this._displayedAssets}setAvailableAssets(e){e.items&&e.items[0]&&e.items[0].assets&&(this._availableAssets=Object(_.a)(Object.keys(e.items[0].assets),e=>K[e]).join("_"))}setDisplayedAssets(e){e.items&&e.items[0]&&e.items[0].assets&&(this._displayedAssets=Object(_.a)(Object.keys(e.items[0].assets),e=>K[e]).join("_"))}}const Y={templateType:X.identity("type"),animatedImage:X.boolean("ani"),flipZIndex:X.boolean("fz"),landscapeOverlay:X.boolean("lo")};class ee{updateTemplate(e,t={}){this.decorationBeaconBuilder=new Z,this.decorationBeaconBuilder.setAvailableAssets(e);const i=this.processConfig(e,t);this.filterAssetByFlight(e,i),this.updatePlacementConfig(e,i),this.updatePlacementImageSize(e,i),this.updateBeacon(e,i)}processConfig(e,t){const i=Object($.a)({},t,J.b);if("river"!==e.region&&(i.templateType=J.a.Default),this.updateSlideshowTemplateType(e,t,i),i.templateType===J.a.PatternOverlay)if(this.isProductItem(e)){const t=this.getItemImageSize(e).height;"174"===t?i.landscapeOverlay=!0:"225"===t?i.landscapeOverlay=!1:i.templateType=J.a.Default}else i.templateType=J.a.Default;return i.templateType!==J.a.ZIndex&&delete i.flipZIndex,i.templateType===J.a.Default&&e.items&&e.items.length>3&&i.adCarousel&&(i.templateType=J.a.AdCarousel),i}updatePlacementConfig(e,t){e.template=t}updatePlacementImageSize(e,t){if(t.templateType===J.a.PatternOverlay){const t=this.getItemImageSize(e);e.imageWidth=Object(h.a)(e,"imageWidth",t.width),e.imageHeight=Object(h.a)(e,"imageHeight",t.height)}}updateBeacon(e,t){if(!Object(G.a)(e.beaconsJson)){const i=JSON.parse(e.beaconsJson);if(i&&Object(z.a)(i.trb)){let s=!1;i.trb=i.trb.map(i=>{if(i.includes("srtb.msn.com")){s=!0;const n=new URL(i);return v.a.appendSearchParam(n,"t",this.serializeTemplateConfig(t)),this.decorationBeaconBuilder.setDisplayedAssets(e),v.a.appendSearchParam(n,"dec",this.decorationBeaconBuilder.availableAssets+"-"+this.decorationBeaconBuilder.displayedAssets),n.href}return i}),s&&(e.beaconsJson=JSON.stringify(i))}}}serializeTemplateConfig(e){return Object(u.a)(Y,(t,i,s)=>{const n=Object(h.a)(e,s);if(n){const e=i(n);if(e)return""===t?e:`${t}_${e}`}return t},"")}updateSlideshowTemplateType(e,t,i){e&&e.items&&e.items[0]&&e.items[0].images&&e.items[0].images.length>1&&(i.templateType=this.SlideshowTemplateType||this.getSlideshowTemplateType(t,i),e.slideshowProps=i.slideshowProps)}getSlideshowTemplateType(e,t){if(this.SlideshowTemplateType=J.a.Default,e&&e.slideshowProps&&t.slideshowProps){const i=Math.floor(100*Math.random());e.slideshowProps.psuedoVideoAllocation&&e.slideshowProps.psuedoVideoAllocation>i?(this.SlideshowTemplateType=J.a.PseudoVideo,t.slideshowProps.autoScrollIntervalMs=e.slideshowProps.psuedoVideoScrollInterval,t.slideshowProps.enableSlideshowMediaControls=!1):(this.SlideshowTemplateType=J.a.Slideshow,t.slideshowProps.autoScrollIntervalMs=e.slideshowProps.slideshowScrollInterval,t.slideshowProps.enableSlideshowMediaControls=!0)}return this.SlideshowTemplateType}getItemImageSize(e){const t=Object(Q.a)(e.items);return Object(G.a)(t)?{}:{width:""+Object(h.a)(t,"imageWidth"),height:""+Object(h.a)(t,"imageHeight")}}isProductItem(e){const t=Object(Q.a)(e.items);return!Object(G.a)(t.assets)}filterAssetByFlight(e,t){if(e&&e.items&&e.items[0]){const i=Object(u.a)(e.items[0].assets,(e,i,s)=>(t.allowedAssets&&t.allowedAssets.includes(K[s])&&(e[s]=i),e),{});e.items[0].assets=i}}}class te{constructor(){this.beaconService=new g.a,this.cmsService=new C,this.samService=new q,this.templateService=new ee,this.cmsNativeAdsItemsMap=new Map,this.cmsRetryCount=0,this.backfillIndex=0,this.cmsAdsCounter=0,this.callbackFnPlacementList=[],this.callbackList=[]}resetNativeAdService(){this.backfillIndex=0,this.cmsAdsCounter=0,this.callbackFnPlacementList.length=0,this.callbackList.length=0,this.samService.clearPreviousInfo()}fetchNativeAds(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void S.a.sendAppErrorEvent(Object(r.a)(o.Gd,"Fetch NativeAd failed","No placements found in the request"));if(e.locale||(e.locale=I.b.Locale),!e.locale)return void S.a.sendAppErrorEvent(Object(r.a)(o.Gd,"Fetch NativeAd failed",`No locale found, headData.Locale: ${I.b.Locale}, adRequest.locale: ${e.locale}`));const t=this.samService.fetchSAMAds(e),i=e.locale,s=a.c[i];if(!this.cmsItems){const e=yield this.cmsService.getCMSList(s,i);e&&(this.cmsItems=e.items)}const n=this.buildAdResponse(e),d=yield t;return this.updateAdResponse(n,this.cmsItems,s,d),n}))}generateFeedbackUrl(e){if(e&&e.length>0){const t=JSON.parse(e).tcb;if(t&&Array.isArray(t)){let e;return t.forEach(t=>{t.includes("srtb")&&(e=t.replace("notify/clicked","notify/feedback"))}),e}}}updateAdResponse(e,t,i,s){const n=!t||0==t.length,a=!s||!s.placements||0==s.placements.length;if(n&&a)return void S.a.sendAppErrorEvent(Object(r.a)(o.Hd,"Fetch NativeAd failed",`Unable to retrieve backfill list id: ${i} and SAM response`));n&&S.a.sendAppErrorEvent(Object(r.a)(o.Hd,"Unable to retrieve backfill list","Backfill list id: "+i));const l=this.mapSAMPlacements(s);return e.pageViewId=s&&s.metaData&&s.metaData.pageViewId,e.placements.forEach(e=>{const i=e.region+e.regionIndex,s=l.get(i);if(s&&s.items&&s.items.length>0){s.items.forEach(t=>{const i={title:t.title,destinationUrl:t.url,imageUrl:t.imageUrl,providerName:t.sourceName,adChoiceIconUrl:t.adChoicesUrl,imageHeight:t.imageHeight,imageWidth:t.imageWidth,clickBeacons:t.clickBeacons,uniqueId:t.uniqueId,feedbackUrl:this.generateFeedbackUrl(t.clickBeacons)};e.items.push(i)}),e.privacyUrl=s.privacyUrl,e.adServedUrls=s.adServedUrls,e.jsTrackerUrls=s.jsTrackerUrls,e.visibilityUrls=s.visibilityUrls,e.beaconsJson=s.beaconsJson,e.bingTrackerUrls=s.bingTrackerUrls,e.geminiViewabilityDataJson=s.geminiViewabilityDataJson,this.beaconService.fireAdServedTrackingCall(s.beaconsJson);const t=!0===I.b.IsPrerender?performance.now()-Object(d.g)(c.d):performance.now();Object(d.o)(A.a.TimeToServeAd,t)}else if(!n){const i=this.backfillIndex++%t.length,s=t[i],n={title:s.title,destinationUrl:s.url,imageUrl:this.updateImageUrl(e,s.imageUrl),providerName:s.provider?s.provider.name:""};e.items.push(n),e.privacyUrl=s.privacyUrl}}),e}fetchSamAds(e,t=!1,i){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void S.a.sendAppErrorEvent(Object(r.a)(o.Gd,"Fetch NativeAd failed","No placements found in the request"));if(e.locale||(e.locale=I.b.Locale),!e.locale)return void S.a.sendAppErrorEvent(Object(r.a)(o.Gd,"Fetch NativeAd failed",`No locale found, headData.Locale: ${I.b.Locale}, adRequest.locale: ${e.locale}`));i&&i.length>0&&this.callbackList.push(...i),this.locale=e.locale;const s=this.samService.fetchSAMAds(e,t);return{placeHolderResponse:this.buildAdResponse(e),samResponse:yield s}}))}fetchCmsAds(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void S.a.sendAppErrorEvent(Object(r.a)(o.Gd,"Fetch NativeAd failed","No placements found in the request"));const s=I.b.Locale;if(!this.cmsNativeAdsItemsMap.has(t)){const e=yield this.cmsService.getCMSList(t,s);e&&e.id&&e.items&&this.cmsNativeAdsItemsMap.set(t,e.items)}const n=this.buildAdResponse(e),a=this.cmsNativeAdsItemsMap.has(t)?this.cmsNativeAdsItemsMap.get(t):[];for(const e of n.placements){const t=i.shift();let n,r;if(t){let e=parseInt(t,10);if(e)e=Math.max(e-1,0),e=e<a.length?e:e%a.length,n=a[e];else{if(!this.cmsNativeAdsItemsMap.has(t)){const e=yield this.cmsService.getCMSList(t,s);e&&e.id&&e.items&&this.cmsNativeAdsItemsMap.set(t,e.items)}const e=this.cmsNativeAdsItemsMap.has(t)?this.cmsNativeAdsItemsMap.get(t):[];n=Object(l.a)(e)[0],n||(n=a[this.cmsAdsCounter%a.length])}}else n=a[this.cmsAdsCounter%a.length];n&&(r={title:n.title,destinationUrl:n.url,imageUrl:n.imageUrl,providerName:n.provider?n.provider.name:""},e.items.push(r),e.privacyUrl=n.privacyUrl),this.cmsAdsCounter++}return n}))}updateSamAdResponse(e,t,i){const s=this.cmsItems,n=this.mapSAMPlacements(t),a=!s||0==s.length;return e.pageViewId=t&&t.metaData&&t.metaData.pageViewId,e.placements.forEach(e=>{const t=e.region+e.regionIndex,r=n.get(t);if(r&&r.items&&r.items.length>0){r.items.forEach(t=>{const i={title:t.title,destinationUrl:t.url,providerName:t.sourceName,adChoiceIconUrl:t.adChoicesUrl,imageUrl:t.imageUrl,imageHeight:t.imageHeight,imageWidth:t.imageWidth,images:t.images,clickBeacons:t.clickBeacons,uniqueId:t.uniqueId,beaconsJson:t.beaconsJson,feedbackUrl:this.generateFeedbackUrl(t.clickBeacons)};this.updateAssetFields(i,t.assets),e.items.push(i)}),e.privacyUrl=r.privacyUrl,e.adServedUrls=r.adServedUrls,e.jsTrackerUrls=r.jsTrackerUrls,e.visibilityUrls=r.visibilityUrls,e.beaconsJson=r.beaconsJson,e.bingTrackerUrls=r.bingTrackerUrls,e.geminiViewabilityDataJson=r.geminiViewabilityDataJson,e.providerId=r.providerId;const t=!0===I.b.IsPrerender?performance.now()-Object(d.g)(c.d):performance.now();Object(d.o)(A.a.TimeToServeAd,t),this.templateService.updateTemplate(e,i)}else if(a)this.handleCmsStandyPlacement(e);else{const t=this.backfillIndex++%s.length,i=s[t],n={title:i.title,destinationUrl:i.url,imageUrl:this.updateImageUrl(e,i.imageUrl),providerName:i.provider?i.provider.name:""};e.items.push(n),e.privacyUrl=i.privacyUrl,e.isBackfill=!0}}),e}handleCmsStandyPlacement(e){if(this.cmsItems){const e=this.cmsItems;for(const t of this.callbackFnPlacementList){const i=e[this.backfillIndex++%e.length],s={title:i.title,destinationUrl:i.url,imageUrl:i.imageUrl,providerName:i.provider?i.provider.name:""};t.items.push(s),t.privacyUrl=i.privacyUrl,t.isBackfill=!0}this.callbackList.forEach(e=>{e(this)}),this.callbackList=[],this.callbackFnPlacementList=[]}else e&&this.callbackFnPlacementList.push(e)}loadCmsBackFillList(){const e=this.locale?this.locale:I.b.Locale,t=a.c[e];this.cmsItems||this.cmsService.getCMSList(t,e).then(e=>{e?(this.cmsItems=e.items,this.handleCmsStandyPlacement()):++this.cmsRetryCount<10&&this.loadCmsBackFillList()})}mapSAMPlacements(e){const t=new Map;return e&&e.placements&&e.placements.forEach(e=>{e.region&&e.index&&t.set(e.region+e.index,e)}),t}buildAdResponse(e){const t=[];e.placements.forEach(e=>{e.region&&e.indices&&e.indices.length&&e.indices.forEach(i=>{const s={region:e.region,regionIndex:i,imageHeight:e.imageHeight,imageWidth:e.imageWidth,items:[]};t.push(s)})});let i=a.a[e.locale];i||(i="Ad");return{placements:t,adLabelText:i,isGreyAdsLabelEnabled:a.g.includes(e.locale),privacyUrl:a.b.PrivacyUrl}}updateImageUrl(e,t){return e&&e.imageWidth&&e.imageHeight&&t?t.replace("w=624","w="+e.imageWidth).replace("h=350","h="+e.imageHeight):t}updateAssetFields(e,t){const i=Object(u.a)(t,(e,t)=>{const i=Object(h.a)(t,"data.type"),s=Object(p.a)(K,e=>e===i);return s&&(e[s]=Object(h.a)(t,"data.value")),e},{});e.assets=i}}let ie;function se(){return ie||(ie=new te),ie.resetNativeAdService(),ie}},eupA:function(e,t,i){"use strict";var s=i("JFdr");t.a=function(e,t){var i=-1,n=e.length,a=n-1;for(t=void 0===t?n:t;++i<t;){var r=Object(s.a)(i,a),o=e[r];e[r]=e[i],e[i]=o}return e.length=t,e}},hV4J:function(e,t,i){"use strict";var s=i("2JSu"),n=i("HVAe"),a=i("p6Gq"),r=i("MyC+"),o=Object.prototype,d=o.hasOwnProperty,c=Object(s.a)((function(e,t){e=Object(e);var i=-1,s=t.length,c=s>2?t[2]:void 0;for(c&&Object(a.a)(t[0],t[1],c)&&(s=1);++i<s;)for(var l=t[i],u=Object(r.a)(l),h=-1,p=u.length;++h<p;){var g=u[h],m=e[g];(void 0===m||Object(n.a)(m,o[g])&&!d.call(e,g))&&(e[g]=l[g])}return e}));t.a=c},hme2:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var s=i("D57K"),n=i("OkDC"),a=i("tMmC"),r=i("HxRh"),o=i("rvYQ"),d=i("msIb"),c=i("6ADy"),l=i("/+Un"),u=i("KETb");class h{constructor(e){this.fetchImpl=e,this.actionsEndpoint="./Graph/Actions",this.defaultOcid="Peregrine"}sendPostActionRequest(e,t=this.defaultOcid){return Object(s.b)(this,void 0,void 0,(function*(){const i=JSON.stringify(e),n={method:"POST",body:i,headers:yield d.a.getOneServiceHeaders()};(yield Object(l.e)())&&(n.credentials="include");const a=Object(c.d)(this.actionsEndpoint);(yield d.a.getCommonParams2(t)).forEach(e=>e.value&&a.searchParams.set(e.key,e.value));return yield Object(u.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(a.href,n);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for Post request: ${a.href} with params ${JSON.stringify(n)}`;throw new Error(t)}return e})),"postAction"+i)}))}sendDeleteActionRequest(e,t=this.defaultOcid){return Object(s.b)(this,void 0,void 0,(function*(){const i=yield d.a.getBaseRequestData("DELETE");(yield Object(l.e)())&&(i.credentials="include");let n="";const a=Object.keys(e),r=a.length;for(let t=0;t<r;t++)n+=`${a[t]} eq '${e[a[t]]}'`,t!=r-1&&r>1&&(n+=" and ");const o={key:"$filter",value:n},h=Object(c.d)(this.actionsEndpoint);[o,...yield d.a.getCommonParams2(t)].forEach(e=>e.value&&h.searchParams.set(e.key,e.value));return yield Object(u.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(h.href,i);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for Delete request: ${h.href} with params: ${JSON.stringify(i)}`;throw new Error(t)}return e})),"deleteAction"+n)}))}}var p=i("tERu"),g=i("u5KZ"),m=i("hxZq"),b=i("HDSB");class v extends class{constructor(e){this.fetchImpl=e,this.ocid="feeds",this.freServiceEndpoint="news/fre",this.userEndpoint="./msn/user",this.actionsClient=new h(e)}getFreArtifacts(e=!1){return Object(s.b)(this,void 0,void 0,(function*(){const t=Object(c.d)(this.freServiceEndpoint);t.searchParams.set("bypass_trigger",""+e);return[...(yield Object(l.d)())===p.c.SignedIn?d.a.getOneServiceParamsWithAuth(Object(o.c)().UserId,this.ocid):d.a.getOneServiceParamsWithoutAuth(Object(o.c)().UserId,this.ocid),{key:m.a,value:Date.now().toString()}].forEach(e=>{e.value&&t.searchParams.set(e.key,e.value)}),this.getFreArtifactsWithUrl(t.href)}))}getFreArtifactsWithUrl(e){return Object(s.b)(this,void 0,void 0,(function*(){if(!e||"-1"===e)return null;const t={method:n.d.Get,credentials:"include",headers:yield d.a.getOneServiceHeaders()};try{const i=yield Object(u.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(e,t)})),"getFreArtifacts");if(!i.ok)throw Error("[FreServiceClient.getFreArtifacts] Failed with response: "+JSON.stringify(i));const n=i.headers&&i.headers.get("ddd-tmpl");return g.a.addOrUpdateTmplString(n),i.json()}catch(e){throw a.a.logError(e.message),e}}))}setFreArtifactForUser(e,t){return Object(s.b)(this,void 0,void 0,(function*(){if(e&&t){const i={method:t,credentials:"include",headers:yield d.a.getOneServiceHeaders()};Object(c.d)(this.freServiceEndpoint);let n=0;try{if(n=(yield Object(u.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(e,i)})),"setFreArtifact")).status,n>=400){const e=`OneService returned error response. Status: ${n} for done action`;throw new Error(e)}}catch(e){return a.a.logError(e.message),n}return n}return g.a.sendAppErrorEvent(Object.assign(Object.assign({},r.Zf),{message:`Any of the required parameters was not properly set by the caller. callbackUrl: ${e} method: ${t}.`})),0}))}updateArtifactInActionsEndpoint(e,t){return Object(s.b)(this,void 0,void 0,(function*(){let i;n.a[e.type]&&(i=Object.assign({},n.a[e.type])),i.targetId=e.id;try{t?yield this.actionsClient.sendPostActionRequest(i,this.ocid):yield this.actionsClient.sendDeleteActionRequest(i,this.ocid)}catch(i){g.a.sendAppErrorEvent(Object.assign(Object.assign({},r.Ad),{message:"Fre Actions call failed",pb:Object.assign(Object.assign({},r.Ad.pb),{customMessage:`artifact: ${JSON.stringify(e)} following: ${t} error message: ${i}`})}))}}))}sendDoneAction(){return Object(s.b)(this,void 0,void 0,(function*(){yield this.setFreState(""+n.b,r.Hb)}))}setDoneFreState(){return Object(s.b)(this,void 0,void 0,(function*(){yield this.setFreState(JSON.stringify({stage:n.b}),r.Hb)}))}setMaybeLaterFreState(){return Object(s.b)(this,void 0,void 0,(function*(){yield this.setFreState(JSON.stringify({dismiss_timestamp:new Date(Date.now()).toJSON()}),r.Cd)}))}setFreState(e,t){return Object(s.b)(this,void 0,void 0,(function*(){const i={method:"POST",body:JSON.stringify({freMultiStepState:e}),headers:yield d.a.getOneServiceHeaders()};(yield Object(l.d)())===p.c.SignedIn&&(i.credentials="include");const n=Object(c.d)(this.userEndpoint);(yield d.a.getCommonParams2(this.ocid)).forEach(e=>e.value&&n.searchParams.set(e.key,e.value));try{yield Object(u.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(n.href,i);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for call to set user state`;throw new Error(t)}return e.json()})),"sendFreDoneAction")}catch(i){g.a.sendAppErrorEvent(Object.assign(Object.assign({},t),{message:"Service call to set fre state failed",pb:Object.assign(Object.assign({},t.pb),{customMessage:`state: ${e} error: ${i}`})}))}}))}}{constructor(e){let t;t=e||(Object(b.a)()?window.fetch.bind(window):fetch),super(t)}}let f;const y=e=>f||(f=new v(e),f)},iCsu:function(e,t,i){"use strict";i.r(t),i.d(t,"DesktopFeedEdgeNext",(function(){return Rt})),i.d(t,"DesktopFeedEdgeNextActions",(function(){return X})),i.d(t,"DesktopFeedEdgeNextConnector",(function(){return ft})),i.d(t,"DesktopFeedEdgeNextReducer",(function(){return St})),i.d(t,"ToolingInfo",(function(){return Mt}));var s=i("+viU"),n=i("8+qV"),a=i("OOuA"),r=i("Nt9a"),o=i("VFke"),d=i("5mwN"),c=i("Jw3B"),l=i("plCa"),u=i("AMBy"),h=i("wXkv"),p=i("Zn5T"),g=i("K1Uj"),m=i("f/Yt"),b=i("0fst"),v=i("0dho"),f=i("rFwl"),y=i("OnwC"),S=i("D57K"),C=i("KHt8"),O=i("P4Ao"),A=i("QBS5"),w=i("oePG");class I extends C.b{constructor(){super(...arguments),this.addCloseButton=!1,this.handleCloseButton=()=>{this.hidden=!0,this.sourceLink="",this.$emit("bing-video-embed-player_close-player")}}}Object(S.c)([A.b],I.prototype,"sourceLink",void 0),Object(S.c)([A.b],I.prototype,"addCloseButton",void 0),Object(S.c)([w.d],I.prototype,"closeButtonAriaLabel",void 0),Object(S.c)([w.d],I.prototype,"closeButtonTelemetryTag",void 0);const j=i("4X57").a`
fluent-dialog::part(control) {
    width: var(--video-player-width);
    height: var(--video-player-height);
    padding: 0;
    display: flex;
    flex-direction: column;
    position: relative;
}

fluent-dialog::part(positioning-region) {
    z-index: 700;
}

.bing-iframe-player {
    width: 100%;
    height: 100%;
    overflow: hidden;
    border-radius: calc(var(--elevated-corner-radius) * 1px);
}

.close-button {
    position: absolute;
    top: 12px;
    right: 12px;
    align-items: center;
    width: 32px;
    height: 32px;
    border-radius: 20px;
    backdrop-filter: blur(4px);
    background: rgba(255, 255, 255, 0.08);
    fill: #ffffff;
    fill-opacity: 0.7;
}

.close-button:hover {
    background: rgba(255, 255, 255, 0.18);
    fill-opacity: 1;
}
`;var T=i("m1Vi"),R=i("6BDD"),M=i("6vBc"),k=i("eUhr");T.b,C.b;const F=R.b`
<fluent-dialog ?hidden=${e=>e.hidden}>
    ${Object(M.a)(e=>e.addCloseButton,R.b`
        <fluent-button
            tabindex="0"
            appearance="stealth"
            class="close-button"
            part="close-button"
            aria-label=${e=>e.closeButtonAriaLabel}

            @click=${e=>e.handleCloseButton()}
            @keypress=${e=>e.handleCloseButton()}
            ${Object(k.b)(e=>e.closeButtonTelemetryTag)}
        >
            <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.1016 1.60156L8.20312 7.5L14.1016 13.3984L13.3984 14.1016L7.5 8.20312L1.60156 14.1016L0.898438 13.3984L6.79688 7.5L0.898438 1.60156L1.60156 0.898438L7.5 6.79688L13.3984 0.898438L14.1016 1.60156Z"
                ></path>
            </svg>
        </fluent-button>
    `)}
    <iframe
        src=${e=>e.sourceLink}
        class="bing-iframe-player"
        frameborder="0"
    />
</fluent-dialog>
`;let D=class extends I{};D=Object(S.c)([Object(O.b)({name:"msn-bing-video-embed-player",template:F,styles:[C.a,j]})],D);class L extends y.a{constructor(e){super(e),this.handledProps={addCloseButton:void 0,closeButtonAriaLabel:void 0,closeButtonTelemetryTag:void 0,hidden:void 0,managedClasses:void 0,sourceLink:void 0,videoEmbedPlayerHeight:void 0,videoEmbedPlayerTelemetryTag:void 0,videoEmbedPlayerWidth:void 0}}render(){const{addCloseButton:e,closeButtonTelemetryTag:t,closeButtonAriaLabel:i,hidden:s,videoEmbedPlayerHeight:n,videoEmbedPlayerWidth:r,sourceLink:o}=this.props,d={"--video-player-width":r,"--video-player-height":n};return Object(a.a)(D,{hidden:s,addCloseButton:e,sourceLink:o,style:d,props:{closeButtonAriaLabel:i,closeButtonTelemetryTag:t}})}}var P=i("rRWH");let x=!0;const E=Object(s.a)(e=>(x="left"===Object(P.b)("left","right",e.direction),{}))(L);var N=i("mXQk"),U=i("ERkP"),W=i.n(U),B=i("7nmT"),H=i.n(B),V=i("dMmp"),q=i("o1qX"),_=i("XlyT"),$=i("HxRh"),G=i("+djJ"),z=i("jrUk"),Q=i("w0HK");class J extends d.a{constructor(e){super(e),this.handledProps=Object.assign(Object.assign({},d.b),{closeColdStartExperience:void 0,coldStartFreResponse:void 0,coldStartConfigInfoFre:void 0,customField:void 0,experienceName:void 0,hasRightRail:void 0,managedClasses:void 0,moneyCardData:void 0,designSystemOverrides:void 0,onUserPaginate:void 0,riverSectionFeedLayoutData:void 0,riverSectionTelemetryObject:void 0,actionsMenuProps:void 0,actionsMenuOpen:void 0,bingVideoCardData:void 0,closeSDCardActionsMenu:void 0,toast:void 0,onUnmount:void 0,onMount:void 0,updateVisibilityFlag:void 0,layoutGap:void 0,reverseLayoutGap:void 0}),this.handleClick=e=>{this.props.actionsMenuProps&&this.props.actionsMenuProps.referrerButton&&!this.props.actionsMenuProps.referrerButton.contains(e.path[0])&&this.actionsMenuEl&&!this.actionsMenuEl.contains(e.path[0])&&this.props.closeSDCardActionsMenu()},this.handleKeyDown=e=>{this.props.actionsMenuProps&&this.props.actionsMenuProps.referrerButton&&!this.props.actionsMenuProps.referrerButton.contains(e.path[0])&&this.actionsMenuEl&&!this.actionsMenuEl.contains(e.path[0])&&this.props.closeSDCardActionsMenu()},this.renderSDCardActionMenu=()=>{const{actionsMenuOpen:e,actionsMenuProps:t}=this.props;return e&&t?H.a.createPortal(Object(a.a)(f.a,Object.assign({},t,{overrideStyles:{zIndex:""+b.a.Above},ref:e=>this.actionsMenuEl=H.a.findDOMNode(e)})),document.getElementById("edge-chromium-page-root")):null},this.onBreakpointChange=e=>{this.setState({columnArrangement:this.props.hasRightRail?this.updateColumnArrangementForRightRail(e):e})},this.onSentinelChange=e=>{if(!e||e.length<1)return;(e[1]||e[0]).isIntersecting?(this.sentinelInView=!0,this.props.onUserPaginate()):this.sentinelInView=!1},this.onMoneyCardAddSymbolClick=()=>{this.props.moneyCardData.setMoneyCardData({cardType:g.b.AddWatchlist,lastCardType:this.props.moneyCardData.cardType,optionSwitch:!1,showSuggestions:!1,noSuggestion:!1,searchSuggestions:[]})},this.onMoneyCardActionInputText=e=>{const t=e.detail;this.props.moneyCardData.handleQuoteSearch(t)},this.onMoneyCardTitleClick=()=>{this.props.moneyCardData.cardType===g.b.AddWatchlist&&this.props.moneyCardData.setMoneyCardData({cardType:this.props.moneyCardData.lastCardType,lastCardType:this.props.moneyCardData.cardType,showSuggestions:!1,noSuggestion:!1,searchSuggestions:[]})},this.addToWatchlist=e=>{const t=e.detail;this.props.moneyCardData.addToWatchlist(t)},this.getColumnArrangementForFeed=e=>{const t=this.state.columnArrangement;switch(t){case c.a.c1:return c.a.c2.toUpperCase();case c.a.c5:return v.a.fiveColSupported()&&e.C5&&e.C5.length>0?c.a.c5.toUpperCase():c.a.c4.toUpperCase();default:return t.toUpperCase()}},this.updateColumnArrangementForRightRail=e=>{switch(e){case c.a.c5:return c.a.c4;case c.a.c4:return c.a.c3;case c.a.c3:return c.a.c2;case c.a.c2:return c.a.c1;default:return e}},this.onBingVideoCardClick=e=>{var t;const i=null===(t=e)||void 0===t?void 0:t.detail;if(!i)return;const s=i.data;if(s&&this.props.bingVideoCardData){const{bingOverlayPlayerSrcFormat:e,pivotSelectionInfo:t}=this.props.bingVideoCardData,n=i.navigateDestination||this.props.bingVideoCardData.navigateDestination;if("Overlay"===n){const t=document.getElementById("bing-video-embed-player-root");if(t&&t.firstElementChild){const i=t.firstElementChild;i&&e&&s.Video&&s.Video.MediaUniqueId&&(i.setAttribute("sourceLink",V.String.Format(e,s.Video.MediaUniqueId)),i.removeAttribute("hidden"))}}else if("Watch"===n)try{Object(Q.a)().switchPivot(Object.assign(Object.assign({},t),{context:{initialVideo:s}}))}catch(e){Object(_.c)(e,$.Cb,"Failed to switch to Watch pivot")}}},this.ttvrFirstSectionFired=!1;const t=Object(l.a)().currentColumnArrangement;this.state={columnArrangement:this.props.hasRightRail?this.updateColumnArrangementForRightRail(t):t},this.desktopFeedEdgeNextContainerRef=W.a.createRef()}componentDidMount(){super.componentDidMount(),this.setIntersectionObserver(),!this.ttvrFirstSectionFired&&this.props.riverSectionFeedLayoutData&&this.props.riverSectionFeedLayoutData.length>0&&(Object(G.l)(h.a.riverFirstSection),this.ttvrFirstSectionFired=!0),Object(l.a)().subscribe(this.onBreakpointChange),"IntersectionObserver"in window&&(this.sentinelObserver=new IntersectionObserver(this.onSentinelChange,{threshold:[0,1]}),requestAnimationFrame(()=>{this.sentinelObserver.observe(document.querySelector("#pagination"))})),this.checkPaginationListeners(),this.props.bingVideoCardData&&"Overlay"===this.props.bingVideoCardData.navigateDestination&&this.renderBingOverlayPlayer(),document.addEventListener("action-add-symbol",this.onMoneyCardAddSymbolClick),document.addEventListener("action-text-input",this.onMoneyCardActionInputText),document.addEventListener("action-title-clicked",this.onMoneyCardTitleClick),document.addEventListener("action-add-to-watchlist",this.addToWatchlist),document.addEventListener("video-card_card-click",this.onBingVideoCardClick),document.addEventListener("mousedown",this.handleClick),document.addEventListener("keydown",this.handleKeyDown),this.props.onMount&&this.props.onMount(),this.props.closeColdStartExperience&&this.coldStartContainerElement&&(this.coldStartContainerElement.addEventListener(N.a,this.props.closeColdStartExperience),this.coldStartContainerElement.addEventListener(N.b,this.props.closeColdStartExperience))}componentDidUpdate(){super.componentDidUpdate(),this.setIntersectionObserver(),!this.ttvrFirstSectionFired&&this.props.riverSectionFeedLayoutData&&this.props.riverSectionFeedLayoutData.length>0&&(Object(G.l)(h.a.riverFirstSection),this.ttvrFirstSectionFired=!0),this.checkPaginationListeners()}componentWillUnmount(){Object(l.a)().unsubscribe(this.onBreakpointChange),this.unsetIntersectionObserver(),this.sentinelObserver&&this.sentinelObserver.unobserve(document.querySelector("#pagination")),this.removeBingOverlayPlayer(),document.removeEventListener("action-add-symbol",this.onMoneyCardAddSymbolClick),document.removeEventListener("action-text-input",this.onMoneyCardActionInputText),document.removeEventListener("action-title-clicked",this.onMoneyCardTitleClick),document.removeEventListener("action-add-to-watchlist",this.addToWatchlist),document.removeEventListener("video-card_card-click",this.onBingVideoCardClick),document.removeEventListener("mousedown",this.handleClick),document.removeEventListener("keydown",this.handleKeyDown),this.props.onUnmount&&this.props.onUnmount(),this.coldStartContainerElement&&this.coldStartContainerElement.removeEventListener(N.a,this.props.closeColdStartExperience),this.coldStartContainerElement&&this.coldStartContainerElement.removeEventListener(N.b,this.props.closeColdStartExperience)}render(){const e=Object(q.a)(this.props.managedClasses.desktopFeedEdgeNext_root,[this.props.managedClasses.desktopFeedEdgeNext_withRightRail,this.props.hasRightRail]);return Object(a.a)("div",Object.assign({},this.unhandledProps(),{className:e}),Object(a.a)("div",{id:"infopane-sentinel",className:this.props.managedClasses.infopaneSentinel}),this.renderRiver(),Object(a.a)("div",{id:"pagination",className:this.props.managedClasses.paginationSentinel}),this.renderSDCardActionMenu(),this.props.toast,Object(a.a)("div",{ref:e=>this.coldStartContainerElement=e},this.props.coldStartFreResponse&&this.renderColdStartFre()),this.props.coldStartFreResponse&&this.renderColdStartFre())}renderRiver(){if(!this.props.riverSectionFeedLayoutData.length)return;const e=Object(q.a)(this.props.managedClasses.feedSection,[this.props.managedClasses.midGap,10===this.props.layoutGap&&!this.props.reverseLayoutGap],[this.props.managedClasses.tinyGap,5===this.props.layoutGap&&!this.props.reverseLayoutGap],[this.props.managedClasses.miniGap,4===this.props.layoutGap&&!this.props.reverseLayoutGap]);return Object(a.a)("div",Object.assign({},this.props.riverSectionTelemetryObject?this.props.riverSectionTelemetryObject.render():null,{className:e}),this.renderRiverSections())}renderRiverSections(){if(!this.props.riverSectionFeedLayoutData.length)return;const e=()=>{const e={};return this.props.layoutGap&&!this.props.reverseLayoutGap&&(e.gap=this.props.layoutGap+"px"),e};return this.props.riverSectionFeedLayoutData.map((t,i)=>Object(a.a)(m.a,{style:e(),key:"riverSection-"+i,attrs:{layout:this.getColumnArrangementForFeed(t.feedData)},props:{data:t.feedData,cardTemplateMap:r.a,layoutStyles:o.a[t.templateId].styles}}))}renderColdStartFre(){const{coldStartFreResponse:e}=this.props,t={coldStartArtifact:e,parentContainerElement:this.coldStartContainerElement};return Object(z.a)(this.props.coldStartConfigInfoFre,this.props.riverSectionTelemetryObject,t)}setIntersectionObserver(){if(!this.props.updateVisibilityFlag)return void this.unsetIntersectionObserver();if(this.intersectionObserver)return;this.intersectionObserver=Object(u.a)(e=>{const{updateVisibilityFlag:t}=this.props;if(t){t(e[0].intersectionRatio>0)}},{threshold:[0]}),this.intersectionObserver.observe(document.querySelector("#infopane-sentinel"))}unsetIntersectionObserver(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0)}checkPaginationListeners(){this.props.riverSectionFeedLayoutData.length&&(this.paginationAnimationFrameId&&cancelAnimationFrame(this.paginationAnimationFrameId),this.checkPaginationTimeout&&clearTimeout(this.checkPaginationTimeout),this.checkPaginationTimeout=setTimeout(()=>{this.sentinelInView&&(this.paginationAnimationFrameId=requestAnimationFrame(()=>{this.paginationAnimationFrameId=null,this.checkPaginationTimeout=null,this.props.onUserPaginate()}))},100))}renderBingOverlayPlayer(){const{bingOverlayPlayerHeight:e,bingOverlayPlayerWidth:t}=this.props.bingVideoCardData,i={addCloseButton:!0,hidden:!0,sourceLink:"",videoEmbedPlayerWidth:t,videoEmbedPlayerHeight:e};if(!document.getElementById("bing-video-embed-player-root")){const e=Object(a.a)(E,Object.assign({},i)),t=document.createElement("div");t.id="bing-video-embed-player-root",document.body.appendChild(t),H.a.render(e,t)}}removeBingOverlayPlayer(){const e=document.getElementById("bing-video-embed-player-root");e&&document.body.removeChild(e)}}J.defaultProps={experienceName:p.a.desktopFeedEdgeNext};var K=i("G82u");class X{}X.setAutoRotate=new K.a("SetAutoRotate"),X.setIsFocused=new K.a("SetIsFocused"),X.setIsMouseOver=new K.a("SetIsMouseOver"),X.setMoneyCardData=new K.a("SetMoneyCardData"),X.setRiverSectionFeedLayoutData=new K.a("SetRiverSectionFeedLayoutData"),X.setWeatherCardData=new K.a("SetWeatherCardData"),X.toggleSDCardActionsMenu=new K.a("ToggleSDCardActionsMenu"),X.setColdStartExperience=new K.a("SetColdStartExperience");var Z=i("y4Tj"),Y=i("Cn94"),ee=i("bYbF"),te=i("oIHq"),ie=i("cASJ"),se=i("hdNv"),ne=i("cxul"),ae=i("8f7u"),re=i("J48h"),oe=i("HN5f"),de=i("S/Dy"),ce=i("dTwT"),le=i("RIQ7"),ue=i("gmMM"),he=i("I6Lx"),pe=i("Ac7j"),ge=i("s9+9"),me=i("Bwzq"),be=i("Uw7R"),ve=i("YUMq"),fe=i("H3ag"),ye=i("LJMo"),Se=i("rGfm"),Ce=i("Z3LZ"),Oe=i("+8mm"),Ae=i("ydPk"),we=i("loKy"),Ie=i("Z118"),je=i("XMfh"),Te=i("5Aq4"),Re=i("tERu"),Me=i("BQg2"),ke=i("rvYQ"),Fe=i("VbA2"),De=i("msIb"),Le=i("KETb"),Pe=i("hxZq"),xe=i("u5KZ"),Ee=i("/+Un");class Ne{constructor(e){this.config=e}fetch(e){return Object(S.b)(this,void 0,void 0,(function*(){let t=this.config.initialRequest;if(e&&(t=Object.assign(Object.assign({},t),e)),!t)return xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.Nf),{message:"default SDService fetch configuration was invalid"})),this.responseStatus=je.a.InvalidRequest,{status:this.responseStatus,cards:void 0};return yield this.fetchSDCards(t)}))}fetchSDCards(e){return Object(S.b)(this,void 0,void 0,(function*(){const t={credentials:"include",headers:yield De.a.getOneServiceFeedCallHeaders(),method:"GET"},i=new URL(Te.l,Te.b),s=Object(Pe.b)();this.requestQueryParams=new Me.a,Object(Te.p)(e,this.requestQueryParams);const n=(yield Object(Ee.d)())===Re.c.SignedIn?De.a.getOneServiceParamsWithAuth(ke.b.UserId,e.ocid,!1):De.a.getOneServiceParamsWithoutAuth(ke.b.UserId,e.ocid,!1);for(let e=0;e<n.length;e++)this.requestQueryParams.set(n[e].key,n[e].value);ke.b.SendFeedCallActivityIdInHeader&&this.requestQueryParams.delete(Te.n.activityId),this.requestQueryParams.set(Te.n.market,ke.b.CurrentMarket);const a=De.a.getLocationParams();let r;a&&this.requestQueryParams.set(a.key,a.value),s>0&&this.requestQueryParams.set(Pe.a,s.toString()),this.requestQueryParams.get("$top")||this.requestQueryParams.set("$top","1"),this.requestQueryParams.get("User")||(this.requestQueryParams.set("User",ke.b.UserId),this.requestQueryParams.delete(Te.n.user)),i.search=this.requestQueryParams.toString();try{const e=1e4,s=yield Object(Le.a)(()=>Object(S.b)(this,void 0,void 0,(function*(){return yield Object(Fe.a)(decodeURIComponent(i.href),e,t)})),"SDCardProvider.fetch");if(!s||!s.ok){const e=s?`SDService returned error response. status: ${s.status} - ${s.statusText}`:"SDService response was null";return xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.Pf),{message:e,pb:Object.assign(Object.assign({},$.Pf.pb),{customMessage:`ServiceUrl: [${i.href}], requestHeaders: [${JSON.stringify(t&&t.headers)}]`})})),void(this.responseStatus=je.a.Failed)}r=yield s.json()}catch(e){return xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.Of),{message:"Error while fetching SDService response",pb:Object.assign(Object.assign({},$.Of.pb),{customMessage:`Error: ${e} serviceUrl: ${i.href} headers: ${JSON.stringify(t.headers)} activityId: ${ke.b.ActivityId}`})})),void(this.responseStatus=je.a.Failed)}return r&&r.cards&&r.cards.length>0?this.responseStatus=je.a.Success:this.responseStatus=je.a.NoContent,r}))}}var Ue=i("860H"),We=i("hme2"),Be=i("HcI6"),He=i("mJFi"),Ve=i("7oW3"),qe=i("1aPi"),_e=i("9RHM"),$e=i("zZnt"),Ge=i("Cj5D"),ze=i("H2C8"),Qe=i("WfnD");const Je={inspect:e=>{var t;const{config:i,state:s,connectorArgs:n}=e,{moneyCardData:a,coldStartFreResponse:r}=s,o=i.bingVideoCardConfig||{},{childExperienceReferencesWC:d}=i,c=[];return{props:{layoutGap:i.layoutGap,reverseLayoutGap:i.reverseLayoutGap,actionsMenuProps:s.actionsMenuProps,actionsMenuOpen:s.actionsMenuOpen,bingVideoCardData:{bingOverlayPlayerHeight:null==o?void 0:o.bingVideoOverlayPlayerHeight,bingOverlayPlayerSrcFormat:null==o?void 0:o.bingVideoPlayerSrcFormat,bingOverlayPlayerWidth:null==o?void 0:o.bingVideoOverlayPlayerWidth,navigateDestination:null==o?void 0:o.navigateDestination,pivotSelectionInfo:null==o?void 0:o.pivotSelectionInfo},coldStartFreResponse:r,designSystemOverrides:i.designSystemOverrides,onUserPaginate:n.onUserPaginate,closeSDCardActionsMenu:n.closeSDCardActionsMenu,riverSectionFeedLayoutData:s.riverSectionFeedLayoutData?s.riverSectionFeedLayoutData:[],onUnmount:n.onUnmount,onMount:n.onMount,updateVisibilityFlag:n.updateVisibilityFlag,hasRightRail:n.hasRightRail,moneyCardData:{cardType:a.cardType,dataFrom:a.dataFrom,lastCardType:a.lastCardType,optionSwitch:a.optionSwitch,actionMenuProps:a.actionMenuProps,userSignedIn:a.userSignedIn,searchSuggestions:a.searchSuggestions,showSuggestions:a.showSuggestions,noSuggestion:a.noSuggestion,moneyCardElement:a.moneyCardElement,financeDataProviderPage:i.moneyCardConfig.financeDataProviderPage,addToWatchlist:n.addToWatchlist,handleQuoteSearch:n.handleQuoteSearch,setMoneyCardData:n.setMoneyCardData,goToAddSymbolCallback:n.goToAddSymbolCallback},toast:(t=>{if(!e.config.childExperienceReferences)return null;const i=e.config.childExperienceReferences[t];if(!i)return null;const s=e.children[i.instanceId];return s||(c.push(i),null)})("toast"),coldStartConfigInfoFre:null===(t=null==d?void 0:d.coldStartWCFre)||void 0===t?void 0:t.experience},missingChildren:c}}},Ke={[ye.a.StockQuote]:"finance",[ye.a.SportsMatch]:"sports",[ye.a.WeatherSummary]:"weather"},Xe={[ne.b.moneyCard]:$.ze,[ne.b.sportsCard]:$.vg,[ne.b.horoscopeAnswerCard]:$.Yd,[ne.b.onThisDayCard]:$.Se,[ne.b.weatherCard]:$.Fh};var Ze=i("+qLX");const Ye="msn/FeedLayout",et="hponeservicefeed",tt="article,video,slideshow,link",it="xfeed",st=1e3,nt="0";var at=i("Fpjf");const rt={path:["v1","cms","api","amp"]};function ot(e,t,i,s){return Object(S.b)(this,void 0,void 0,(function*(){try{if(!e)throw new Error("Unable to find content id in config");const s=(e=>{const t=new URL("/content/",ke.b.ContentServiceUrlBase),i=[...rt.path];return i.push("list"),i.push(e),t.pathname+=i.join("/"),t})(e),n=yield fetch(s.href),a=yield n.json();if(a&&a.list&&a.list.length)return function(e,t,i){const s=[];if(e&&e.list)for(let n=0;n<e.list.length&&n<t;n++){const t=e.list[n].link&&e.list[n].link.image?dt(e.list[n].link.image.href):null,a=t?Object(at.g)(t,{width:200,height:i,enableDpiScaling:!1}):null;s.push({query:e.list[n].link.title,url:e.list[n].link.href,images:a?[{imageUrl:a}]:[]})}return{searchItems:s}}(a,t,i);throw new Error("Backfill data couldn't be retrieved")}catch(t){let i;"object"==typeof t?i=t.toString():"string"==typeof t&&(i=t);const n=s?"Recommended Search Below Search Box: ":"Recommended Search Module: ";xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.Ff.ContentFetchError),{message:i,pb:Object.assign(Object.assign({},$.af.FetchFailure.pb),{customMessage:`${n}Content couldn't be retrieved for contentId = ${e||""}`})}))}}))}function dt(e){return e&&e.toLowerCase().indexOf("cms/api/amp/image")>-1?e.substring(e.lastIndexOf("/")+1):null}var ct=i("y+Kz"),lt=i("6ADy");function ut(e,t,i,s){return Object(S.b)(this,void 0,void 0,(function*(){if(!e)throw new Error("Unable to find one service id in config");const n=yield De.a.getBaseRequestData("GET"),a=[...De.a.getOneServiceParamsWithoutAuth(null,s||et,!1),{key:ct.w.contentType,value:tt},{key:ct.w.top,value:t.toString()},{key:ct.w.ids,value:e},{key:"t",value:it},{key:ct.w.timeOut,value:""+i},{key:ct.w.infoPaneItemCount,value:nt}],r=Object(lt.d)(Ye);a.forEach(e=>e.value&&r.searchParams.set(e.key,e.value));const o=yield Object(Le.a)(()=>Object(S.b)(this,void 0,void 0,(function*(){const e=yield fetch(r.href,n);if(!e.ok)throw Error(`Response status: ${e.status}. Response statusText: ${e.statusText}.`);return e.json()})),"getTrendingNowFeed");if(!o.value||!o.value.length||!o.value[0]||!o.value[0].subCards||!o.value[0].subCards.length||o.value[0].subCards.length<t)throw new Error("Endpoint did not return enough feed items to display");const d=ke.b.TrackInfo.sitePage.page_product;return{trendingTerms:o.value[0].subCards.map(({categories:e,id:t,title:i,type:s,url:n})=>{n=function(e,t){if(!e||!t)return e;if(e.indexOf("hponeservicefeed")<0)return e;return e.replace("hponeservicefeed",Object(le.b)())}(n,d);const a=e&&e[0]&&e[0].product||"";return{category:e&&e[0]&&e[0].label&&e[0].label.substring(a.length)||"",vertical:a,id:t,title:i,type:s,href:n}})}}))}var ht=i("XLvf"),pt=i("C/Vb"),gt=i("A8DD"),mt=i("MSQM");const bt=Object(be.a)();var vt;!function(e){e[e.FirstFetchAndRenderContent=0]="FirstFetchAndRenderContent",e[e.SubFetchAndRenderContent=1]="SubFetchAndRenderContent",e[e.RenderContent=2]="RenderContent"}(vt||(vt={}));class ft extends Qe.a{constructor(e,t,i,s,n,a,r){super(e,t,i,s,n,a,r),this.isFetchingContent=!1,this.infoPaneNativeAdsMap=[],this.riverNativeAdsMap=[],this.cmsInfopaneNativeAdsMap=[],this.cmsRiverNativeAdsMap=[],this.unRenderedLayoutTemplate=[],this.unRenderedRiverContent=[],this.visualReadinessCallbackSet=!1,this.ttvrFired=!1,this.isFirstBatchCall=!0,this.isFirstFeedCall=!0,this.beaconService=new te.a,this.visualState={isWindowFocused:"visible"===document.visibilityState,isDocumentVisible:"visible"===document.visibilityState,inViewport:!0},this.waitingAdsMap=new Map,this.cmsAdsConfig={documentId:"",infoPaneIndices:[],riverIndices:[]},this.infoPaneAdRegionIndexList=[],this.riverAdRegionIndexList=[],this.infoPaneCmsAdRegionIndexList=[],this.riverCmsAdRegionIndexList=[],this.unServedSamAdSet=new Set,this.adServedCount=0,this.awayTimestamp=1/0,this.onMount=()=>{window.addEventListener("blur",this.handleWindowBlur),window.addEventListener("focus",this.handleWindowFocus),document.addEventListener("visibilitychange",this.handleDocumentVisibilityChange)},this.onUnmount=()=>{window.removeEventListener("blur",this.handleWindowBlur),window.removeEventListener("focus",this.handleWindowFocus),document.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange)},this.handleWindowFocus=Object(qe.a)(()=>{this.visualState.isWindowFocused=!0,this.tryResumeAutoRotate()},50,{leading:!0,trailing:!1}),this.handleWindowBlur=Object(qe.a)(()=>{this.visualState.isWindowFocused=!1,this.setAutoRotate(!1)},50,{leading:!0,trailing:!1}),this.handleDocumentVisibilityChange=()=>{this.visualState.isDocumentVisible="visible"===document.visibilityState,this.visualState.isDocumentVisible?(this.checkAwayTime(),this.tryResumeAutoRotate()):(this.updateAwayTime(),this.setAutoRotate(!1))},this.onScroll=()=>{this.prefetchNextFeedAndAds(),window.removeEventListener("scroll",this.onScroll)},this.setVisuallyReadyMarkers=()=>{this.ttvrFired||(this.ttvrFired=!0,window.requestAnimationFrame(()=>{setTimeout(()=>{Object(G.k)(p.a.desktopFeedEdgeNext);const e=Object(Ce.g)();e&&Oe.a.updateVisuallyReadyTiming.getActionSender(e).send(Object(Ce.c)(p.a.desktopFeedEdgeNext,void 0,void 0,void 0,window.performance.now()))},0)}))},this.cardActionClickHandler=(e,t,i,s,n)=>{if(!e||!t)return;const{riverSectionFeedLayoutData:a}=this.getCurrentState(),r=Object(se.f)(t);if(a&&a.length){const d=[];a.forEach(t=>{const i=[];let s=!1;t.cardMetadataList.forEach(t=>{if(t.type===ye.a.Infopane){const n=t;n.subItems.forEach(t=>{t.id===e&&(s=!0,t.metadata=t.metadata||{},t.metadata.actions=r)}),i.push(n)}else{const n=t;n.id===e&&(s=!0,n.metadata=n.metadata||{},n.metadata.actions=r),i.push(n)}}),d.push(s?{feedData:this.mapFeedData(i,o.a[t.templateId],!1,this.riverSectionTelemetryObject),templateId:t.templateId,cardMetadataList:Object(_e.a)(i)}:t)}),s&&n?this.cardActionServiceClient.PostCardActionV2Event(t,i,e,void 0,n):this.cardActionServiceClient.PostCardActionV2Event(t,i,e),X.setRiverSectionFeedLayoutData.getActionSender(this).send(d)}},this.activeItemChangedHandler=(e,t)=>{if(!e)return;const{riverSectionFeedLayoutData:i}=this.getCurrentState();if(i&&i.length){const s=[];i.forEach(i=>{const n=[];let a=!1;i.cardMetadataList.forEach(i=>{const s=i;s.id===e&&(a=!0,s.activeIndexForMultiAds=t),n.push(s)}),s.push(a?{feedData:this.mapFeedData(n,o.a[i.templateId],!1,this.riverSectionTelemetryObject),templateId:i.templateId,cardMetadataList:Object(_e.a)(n)}:i)}),X.setRiverSectionFeedLayoutData.getActionSender(this).send(s)}},this.initCardAction=e=>{Y.a.Init.getGlobalActionSender().send(Object.assign(Object.assign({},e),{overrideStyles:{zIndex:""+b.a.Above}}))},this.onUserPaginate=()=>{this.previousRiverSectionContentResponse&&Object(Ce.j)().then(()=>this.renderNextFeed())},this.goToPersonalizeCallback=()=>{const{oneRiverInterestsPivotInfo:e}=this.config;Object(Q.a)().switchPivot({pivotId:e.pivotId,configIndexHref:e.configIndexHref,configIndexRef:e.configIndexRef,context:{isRequestFromSdCardAddRemoveClick:!1},telemetryPageName:Ze.a.Interests,display:e.displayName})},this.clickSDCardActionButton=(e,t)=>{e.menuItems.forEach(e=>{"edit"===e.id?t===ne.b.weatherCard?e.onClick=this.switchToWeatherSetting:ne.b.trafficCard:"hide"===e.id?t===ne.b.weatherCard?e.onClick=this.hideWeatherCardAndRefresh:t===ne.b.moneyCard&&(e.onClick=this.hideMoneyCardAndRefresh):"more"===e.id?t===ne.b.sportsCard?e.onClick=this.goToPersonalizeCallback:e.onClick=this.goToPersonalizeSettingsCallback:"dataProvider"===e.id?e.onClick=this.showMoneyCardDataProvider:"addWatchlist"===e.id&&(e.onClick=this.goToAddSymbolCallback)}),e.onDismiss=this.closeSDCardActionsMenu;const i=!this.getCurrentState().actionsMenuOpen;X.toggleSDCardActionsMenu.getActionSender(this).send(e,i)},this.switchToWeatherSetting=()=>{this.setWeatherCardData({cardMode:"setting",setUnit:void 0,setLocMode:void 0,selectLocation:void 0,suggestedLocations:void 0}),X.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.mapSDCardDataToFeedLayout=e=>Object(S.b)(this,void 0,void 0,(function*(){const t=yield this.fetchFeedContent(null,Ie.b.partial);if(t.status===je.a.Success){let i,s,n;t.sections.forEach((t,a)=>{n=t.cards.find(t=>t.type===e),n&&(s=n,i=a)});const a=this.getCurrentState().riverSectionFeedLayoutData,r=a[i],d=r.cardMetadataList.findIndex(t=>t.type===e),c=[...r.cardMetadataList.slice(0,d),s,...r.cardMetadataList.slice(d+1)],l=Object.assign(Object.assign({},r),{feedData:this.mapFeedData(c,o.a[r.templateId],!0,this.riverSectionTelemetryObject),cardMetadataList:c});X.setRiverSectionFeedLayoutData.getActionSender(this).send([...a.slice(0,i),l,...a.slice(i+1)])}})),this.setAboveTheFoldRiverSectionFeedLayoutData=()=>{const e=this.getCurrentState().riverSectionFeedLayoutData,t=e[0];if(t){const i=Object.assign(Object.assign({},t),{feedData:this.mapFeedData(t.cardMetadataList,o.a[t.templateId],!0,this.riverSectionTelemetryObject)});X.setRiverSectionFeedLayoutData.getActionSender(this).send([i,...e.slice(1)])}},this.refreshSDCardSection=()=>Object(S.b)(this,void 0,void 0,(function*(){const e=yield this.fetchFeedContent(null,Ie.b.partial),t=this.getCurrentState().riverSectionFeedLayoutData;if(e.status===je.a.Success&&t){const i=e.sections.length,s=t.slice(0,i),n=e.sections,a=[],r=[];s.forEach(e=>{e.cardMetadataList.forEach(e=>{e.type===ye.a.Infopane?e.subItems.forEach(t=>{t.type!==ye.a.NativeAd&&e.type!==ye.a.CmsAd||a.push(t)}):e.type!==ye.a.NativeAd&&e.type!==ye.a.CmsAd||r.push(e)})}),n.forEach(e=>{e.cards.forEach((t,i)=>{t.type===ye.a.Infopane?t.subItems.forEach((e,i)=>{e.type!==ye.a.NativeAd&&e.type!==ye.a.CmsAd||(t.subItems[i]=a.shift())}):t.type!==ye.a.NativeAd&&t.type!==ye.a.CmsAd||(e.cards[i]=r.shift())})});const d=s.map((e,t)=>Object.assign(Object.assign({},e),{feedData:this.mapFeedData(n[t].cards,o.a[n[t].layoutTemplate],!0,this.riverSectionTelemetryObject),cardMetadataList:n[t].cards}));X.setRiverSectionFeedLayoutData.getActionSender(this).send([...d,...t.slice(2)])}})),this.setWeatherCardData=e=>Object(S.b)(this,void 0,void 0,(function*(){X.setWeatherCardData.getActionSender(this).send(e),yield this.mapSDCardDataToFeedLayout(ye.a.WeatherSummary)})),this.hideWeatherCardAndRefresh=()=>Object(S.b)(this,void 0,void 0,(function*(){const e=yield this.weatherPdpClient.disableWeatherCard();if(X.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1),e&&(yield Object(Pe.d)(),yield this.refreshSDCardSection()),this.pageSettingsDataConnector){const{sdCardSettings:e}=this.pageSettingsDataConnector.getCurrentState();e.weatherVisible=!1,pe.a.updateLocalStorage.getActionSender(this.pageSettingsDataConnector).send(e)}else if(Object(ce.a)().supported){const e=Object(ce.a)().getObject($e.c,$e.b);e&&(e.weatherVisible=!1),Object(ce.a)().setObject($e.c,e)}return e})),this.hideMoneyCardAndRefresh=()=>Object(S.b)(this,void 0,void 0,(function*(){const e=yield this.financeUserService.disableMoneyCard();if(X.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1),e&&(yield Object(Pe.d)(),yield this.refreshSDCardSection()),this.pageSettingsDataConnector){const{sdCardSettings:e}=this.pageSettingsDataConnector.getCurrentState();e.moneyVisible=!1,pe.a.updateLocalStorage.getActionSender(this.pageSettingsDataConnector).send(e)}else if(Object(ce.a)().supported){const e=Object(ce.a)().getObject($e.c,$e.b);e.moneyVisible=!1,Object(ce.a)().setObject($e.c,e)}return e})),this.goToPersonalizeSettingsCallback=()=>{Object(Ge.c)(this.config.oneRiverInterestsPivotInfo,!1),this.getCurrentState().actionsMenuOpen&&X.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.showMoneyCardDataProvider=()=>{window.open(this.config.moneyCardConfig.financeDataProviderPage,"_blank"),X.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.closeSDCardActionsMenu=()=>{X.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.handleNavClick=(e,t)=>Object(S.b)(this,void 0,void 0,(function*(){var t,i,s;let n=null===(t=this.getCurrentState().moneyCardData)||void 0===t?void 0:t.multiTabQuoteItems;n&&n[e]||(yield this.refreshMoneyCardData(),n=null===(i=this.getCurrentState().moneyCardData)||void 0===i?void 0:i.multiTabQuoteItems);const a=n[e];if(e===ae.b.Watchlist){const t=(null===(s=this.getCurrentState().moneyCardData)||void 0===s?void 0:s.suggestedQuoteItems)||[],[i,r]=this.getCorrectWatchlist(a,t);return n[ae.b.Watchlist]=a,void this.setMoneyCardData({cardType:re.b.EdgeShowData,quoteItems:i,suggestedQuoteItems:r,multiTabQuoteItems:n,activeTab:e})}this.setMoneyCardData({cardType:re.b.EdgeShowData,quoteItems:a,activeTab:e})})),this.getCorrectWatchlist=(e,t)=>{let i=e||[],s=t||[];if(t.length>0){const e=this.addedQuoteIds||[],t=s.filter(t=>e.includes(t.id));i=i.concat(t),s=s.filter(t=>!e.includes(t.id))}return[i,s]},this.handleAddToWatchlist=e=>Object(S.b)(this,void 0,void 0,(function*(){let t=this.addedQuoteIds||[];t=[...t],t.includes(e)||t.push(e),this.addedQuoteIds=t})),this.refreshMoneyCardData=()=>Object(S.b)(this,void 0,void 0,(function*(){var e,t,i,s,n,a,r,o,d;yield Object(Pe.d)();const c=this.financeUserService.getWatchlist(),l=this.financeService.getMarketMovers(),[u,h]=yield Promise.all([c,l]),p=(null===(e=this.config.moneyCardConfig)||void 0===e?void 0:e.maxNumQuotes)?null===(t=this.config.moneyCardConfig)||void 0===t?void 0:t.maxNumQuotes:3,g=null==u?void 0:u.slice(0,p),m=null===(s=null===(i=this.config.moneyCardConfig)||void 0===i?void 0:i.marketQuoteIds)||void 0===s?void 0:s.slice(0,p),b=null===(a=null===(n=this.config.moneyCardConfig)||void 0===n?void 0:n.currencyQuoteIds)||void 0===a?void 0:a.slice(0,p),v=null===(r=h.active)||void 0===r?void 0:r.slice(0,p),f=null===(o=h.gainers)||void 0===o?void 0:o.slice(0,p),y=null===(d=h.losers)||void 0===d?void 0:d.slice(0,p),S=this.getSuggestedQuoteIds(g,p),C=[...g,...m,...b,...v,...f,...y,...S],O=yield this.financeService.getQuoteSummary(C),A=this.getQuoteMapIdToItem(O),w=this.getQuoteItemsByIds(A,g),I=this.getQuoteItemsByIds(A,m),j=this.getQuoteItemsByIds(A,b),T=this.getQuoteItemsByIds(A,v),R=this.getQuoteItemsByIds(A,f),M=this.getQuoteItemsByIds(A,y),k=this.getQuoteItemsByIds(A,S),[F,D]=this.getCorrectWatchlist(w,k),L={[ae.b.Watchlist]:F,[ae.b.Market]:I,[ae.b.Currencies]:j,[ae.b.Movers]:T,[ae.b.Gainers]:R,[ae.b.Losers]:M,[ae.b.Recent]:[]},P=this.getCurrentState().moneyCardData.activeTab;this.setMoneyCardData({cardType:re.b.EdgeShowData,suggestedQuoteItems:D,quoteItems:L[P],multiTabQuoteItems:L})})),this.getQuoteMapIdToItem=e=>{const t=new Map;if(!e)return t;for(let i=0;i<e.length;i+=1){const s=e[i],n=s.id;t.set(n,s)}return t},this.getQuoteItemsByIds=(e,t)=>{if(!e||!t||0===t.length)return[];const i=[];for(let s=0;s<t.length;s+=1){const n=t[s];if(e.has(n)){const t=e.get(n);i.push(t)}}return i},this.getSuggestedQuoteIds=(e,t)=>{var i,s;if(!e||e.length>=t)return[];let n=(null===(s=null===(i=this.config)||void 0===i?void 0:i.moneyCardConfig)||void 0===s?void 0:s.suggestedQuoteIds)||[];return n=n.filter(t=>!e.includes(t)),n=n.slice(0,t-e.length),n},this.saveWeaSettingAndRefresh=e=>Object(S.b)(this,void 0,void 0,(function*(){e&&e.changeSignal&&(yield this.saveWeaSettings(e),yield Object(Pe.d)()),X.setWeatherCardData.getActionSender(this).send({cardMode:"forecast"}),yield this.mapSDCardDataToFeedLayout(ye.a.WeatherSummary)})),this.triggerWeatherLocAutoSuggest=e=>Object(S.b)(this,void 0,void 0,(function*(){let t=void 0;const i=e.trim();if(i){const e=yield this.weatherAutoSuggestClient.getAutoSuggestResponse(i);null!=e&&(t=e)}this.setWeatherCardData({suggestedLocations:t})})),this.switchToWeatherForecast=()=>{this.setWeatherCardData({cardMode:"forecast",setUnit:void 0,setLocMode:void 0,selectLocation:void 0,suggestedLocations:void 0})},this.selectWeatherLocationMode=e=>{this.setWeatherCardData({setLocMode:e})},this.selectWeatherUnit=e=>{this.setWeatherCardData({setUnit:e})},this.selectWeatherLocation=e=>{this.setWeatherCardData({selectLocation:e,suggestedLocations:void 0})},this.setMoneyCardData=e=>{X.setMoneyCardData.getActionSender(this).send(e),this.mapSDCardDataToFeedLayout(ye.a.StockQuote)},this.addToWatchlist=e=>Object(S.b)(this,void 0,void 0,(function*(){yield this.financeUserService.addToWatchlist(e),this.setMoneyCardData({cardType:re.b.ShowData,searchSuggestions:[],showSuggestions:!1,noSuggestion:!1}),yield Object(Pe.d)(),this.refreshFeed()})),this.goToAddSymbolCallback=()=>{if(this.config.moneyCardConfig.disableInLineAddWatchlist){const e=Object(le.b)(),t=new URL(this.config.moneyCardConfig.financeWatchlistPage);e&&t.searchParams.append("ocid",e),window.open(t.href,"_blank")}else this.setMoneyCardData({cardType:re.b.AddWatchlist,lastCardType:this.getCurrentState().moneyCardData.cardType,optionSwitch:!1,showSuggestions:!1,noSuggestion:!1,searchSuggestions:[]});X.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.handleQuoteSearch=Object(qe.a)(e=>Object(S.b)(this,void 0,void 0,(function*(){const t=e.trim();if(""!==t)try{const e=yield this.autoSuggestServiceConnect.getAutoSuggest(t,4);return void(e&&0!==e.length?this.setMoneyCardData({cardType:re.b.AddWatchlist,searchSuggestions:e,showSuggestions:!0,noSuggestion:!1}):this.setMoneyCardData({cardType:re.b.AddWatchlist,showSuggestions:!1,noSuggestion:!0}))}catch(e){this.setMoneyCardData({cardType:re.b.AddWatchlist,showSuggestions:!1,noSuggestion:!0})}else this.setMoneyCardData({cardType:re.b.AddWatchlist,showSuggestions:!1,noSuggestion:!1})})),200),this.setAutoRotate=e=>{X.setAutoRotate.getActionSender(this).send(e),this.setAboveTheFoldRiverSectionFeedLayoutData()},this.focusinHandler=()=>{X.setIsFocused.getActionSender(this).send(!0),this.setAutoRotate(!1)},this.focusoutHandler=()=>{X.setIsFocused.getActionSender(this).send(!1),this.tryResumeAutoRotate()},this.mouseenterHandler=()=>{X.setIsMouseOver.getActionSender(this).send(!0),this.setAutoRotate(!1)},this.mouseleaveHandler=()=>{X.setIsMouseOver.getActionSender(this).send(!1),this.tryResumeAutoRotate()},this.tryResumeAutoRotate=()=>{if(!this.getCurrentState())return;const{isFocused:e,isMouseOver:t}=this.getCurrentState(),{isWindowFocused:i,isDocumentVisible:s,inViewport:n}=this.visualState;!e&&!t&&i&&s&&n&&this.setAutoRotate(!0)},this.updateVisibilityFlag=e=>{this.visualState.inViewport=e,e?this.tryResumeAutoRotate():this.setAutoRotate(!1)},this.onReaction=(e,t,i)=>{Ue.a.sendContentReaction(e,t,i)},this.initializeColdStartExperience=(e=!1)=>{const{experience:t}=this.config.childExperienceReferencesWC.coldStartWCFre||{};t&&Object(Ce.j)().then(()=>{try{Object(We.a)().getFreArtifacts(e).then(e=>{e&&e.fre?X.setColdStartExperience.getActionSender(this).send(e):e&&Object(ht.isNullOrUndefined)(e.fre)&&e.subCards&&e.subCards.length&&Object(_.b)($.zb,"FRE request was made but returned no flag or empty data")})}catch(e){Object(_.c)(e,$.Pd,"Getting data for the required artifacts failed in desktop feed when initializing cold start experience")}})},this.closeColdStartExperience=()=>{X.setColdStartExperience.getActionSender(this).send(null)},this.pageSettingsDataConnector=i.connector(ge.a.ChromiumPageSettings),this.nativeAdService=Object(ie.b)(),this.cardActionServiceClient=new ee.a(window.fetch.bind(window)),this.weatherPdpClient=new Be.a,this.weatherAutoSuggestClient=Object(He.a)(a&&a.weatherCardConfig&&a.weatherCardConfig.weatherAutoSuggestionConfig),this.addedQuoteIds=[],this.financeUserService=de.a.getFinanceUserService(),this.financeService=de.a.getCachedFinanceService(),this.autoSuggestServiceConnect=de.a.getAutoSuggestService(),Object(Ce.j)().then(()=>{this.nativeAdService.loadCmsBackFillList()}),this.updateNativeAdsFromCmsCallback=(e=>{this.updateNativeAdsMap(e.callbackFnPlacementList),this.updateNativeAdsInRiverSections()}).bind(this)}mapStateToProps(e){const t=Je.inspect({config:this.config,children:this.childComponentInstanceList,state:e,connectorArgs:{addToWatchlist:this.addToWatchlist,goToAddSymbolCallback:this.goToAddSymbolCallback,handleQuoteSearch:this.handleQuoteSearch,onUserPaginate:this.onUserPaginate,setMoneyCardData:this.setMoneyCardData,closeSDCardActionsMenu:this.closeSDCardActionsMenu,onMount:this.onMount,onUnmount:this.onUnmount,updateVisibilityFlag:this.updateVisibilityFlag,hasRightRail:this.hasRightRail}});return Object.assign(Object.assign({},t.props),{riverSectionTelemetryObject:this.riverSectionTelemetryObject,closeColdStartExperience:this.closeColdStartExperience})}onComponentConnect(e){var t,i,s;return Object(S.b)(this,void 0,void 0,(function*(){yield Qe.a.prototype.onComponentConnect.call(this,e);let n=this.config.riverSectionCardProviderConfig;const a=this.config.riverSectionSDCardProviderConfig;let r;this.feedId=null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.feedId,this.feedName=null===(i=null==e?void 0:e.context)||void 0===i?void 0:i.query,this.hasRightRail=null===(s=null==e?void 0:e.context)||void 0===s?void 0:s.hasRightRail,(this.feedId||this.feedName)&&(r=this.feedId||this.feedName,n=this.updateInitialRequest()),this.riverCardProvider=new Ie.a(n),this.SDCardProvider=new Ne(a),Se.a.refreshRiver.registerObserver(()=>Object(S.b)(this,void 0,void 0,(function*(){yield Object(Pe.d)(),this.refreshFeed()}))),this.refreshFeed(),this.riverSectionTelemetryObject=this.telemetryObject.addOrUpdateChild({name:"River",content:{headline:r||"RiverSection"}}),bt[h.a.desktopFeedStart]=window.performance.now(),this.config.childExperienceReferences&&(yield this.loadChildrenExperiences(Object.keys(this.config.childExperienceReferences).filter(e=>this.filterEmptyChildExperience(e)).map(e=>this.config.childExperienceReferences[e]))),Object(Q.a)().addSwitchListener(()=>{window.removeEventListener("scroll",this.onScroll)},we.a.Monetization),this.fetchTrendingNowData(),this.fetchRecommendedSearchData(),Promise.all([Object(gt.a)(),this.requestPageVisibleAsync()]).then(()=>{this.visualState=this.getInitialVisualState(),this.tryResumeAutoRotate()})}))}fetchRecommendedSearchData(){return Object(S.b)(this,void 0,void 0,(function*(){if(!this.config.recommendedSearchConfig)return;yield Object(Ce.j)();const e=yield function(e,t,i,s){return Object(S.b)(this,void 0,void 0,(function*(){const n=s||200,a=ot(e.backfillContentId,e.numberOfTermsSupported||8,n,t),r=e.serviceCallParameters.requestId||xe.a.getRequestId(),o=i?[{id:r,ext:{image:{w:200,h:n}}}]:[{id:r}],d={ext:{pageType:e.serviceCallParameters.pageType,appId:e.serviceCallParameters.appId},id:r,imp:o,site:{cat:["trendingrecs"],content:{url:"https://www.msn.com/"},domain:"www.msn.com",keywords:"default",page:"https://www.msn.com/",publisher:{ext:{adunitid:e.serviceCallParameters.adUnitId,propertyid:e.serviceCallParameters.propertyId,formcode:e.serviceCallParameters.formCode,partnercode:e.serviceCallParameters.partnerCode},id:"17160724",name:"MSN"}}};let c;const l={method:"GET",credentials:"include"},u=t?"Recommended Search Below Search Box: ":"Recommended Search Module: ";try{let t=null;const i=fetch(e.serviceCallParameters.apiEndpoint+"?appid="+e.serviceCallParameters.appId+"&q="+encodeURI(JSON.stringify(d)),l),s=e.serviceCallParameters.apiTimeoutInMilliSeconds,n=new Promise(e=>{t=setTimeout(e,s)}),r=yield Promise.race([n.then(()=>{throw new Error("timeout: recommended search api response not received within "+e.serviceCallParameters.apiTimeoutInMilliSeconds+" ms.")}),i]);clearTimeout(t);const o=r;if(!o||!o.ok)throw new Error("recommended search service returned error response: "+r.status);try{c=yield o.json()}catch(e){return xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.Ff.ResponseParsingFailed),{message:"Error while getting Json from response.",pb:Object.assign(Object.assign({},$.Ff.ResponseParsingFailed.pb),{customMessage:u+"Error while getting Json from response."})})),a}if(!c||!c.impressions||!c.impressions[0].queries)return xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.Ff.InvalidJsonResponse),{message:"Didn't get valid JSON from response.",pb:Object.assign(Object.assign({},$.Ff.InvalidJsonResponse.pb),{customMessage:u+"Didn't get valid JSON from response."})})),a}catch(e){let t=$.Ff.ServiceCallFailed;return-1!==e.message.indexOf("timeout")&&(t=$.Ff.Timeout),xe.a.sendAppErrorEvent(Object.assign(Object.assign({},t),{message:""+e,pb:Object.assign(Object.assign({},t.pb),{customMessage:`${u}${e}`})})),a}return function(e){return{searchItems:e.impressions[0].queries}}(c)}))}(this.config.recommendedSearchConfig),t=[];e.searchItems.forEach(e=>{t.push({title:e.query,href:e.url})}),this.recommendedSearchData=t,this.setAboveTheFoldRiverSectionFeedLayoutData()}))}fetchTrendingNowData(){return Object(S.b)(this,void 0,void 0,(function*(){try{if(!this.config.trendingNewsConfig)return;yield Object(Ce.j)();const{oneServiceId:e,numberOfTermsToDisplay:t,ocid:i,timeoutMs:s}=this.config.trendingNewsConfig,n=s||st,a=yield ut(e,t,n,i);this.trendingNewsData=a.trendingTerms,this.setAboveTheFoldRiverSectionFeedLayoutData()}catch(e){let t;return"object"==typeof e?t=e.toString():"string"==typeof e&&(t=e),void xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.gh.ContentFetchError),{message:t}))}}))}filterEmptyChildExperience(e){const t=this.config.childExperienceReferences[e];return Object(ue.h)(t)}refreshFeed(){this.setCmsConfig(),this.waitingAdsMap.clear(),this.riverCardProvider.clearCache(),this.previousRiverSectionContentResponse=null,this.unRenderedLayoutTemplate=[],this.unRenderedRiverContent=[],this.infoPaneAdRegionIndexList=[],this.riverAdRegionIndexList=[],this.infoPaneCmsAdRegionIndexList=[],this.riverCmsAdRegionIndexList=[],this.adServedCount=0,this.isFirstFeedCall=!0,this.unServedSamAdSet.clear(),this.infoPaneNativeAdsMap=[],this.riverNativeAdsMap=[],this.cmsInfopaneNativeAdsMap=[],this.cmsRiverNativeAdsMap=[],this.samAdsInitialUpperBound=this.config.samAdsInitialUpperBound,this.nativeAdService.resetNativeAdService(),this.renderNextFeed(!0)}renderNextFeed(e){return Object(S.b)(this,void 0,void 0,(function*(){if(this.config.isNewPrefetchlogic)return this.renderNextFeedWithPrefetch(e);let t=vt.RenderContent;if(0===this.unRenderedLayoutTemplate.length){if(!(yield this.getContentForNextFeed(e)))return;this.isFirstFeedCall?(t=vt.FirstFetchAndRenderContent,this.isFirstFeedCall=!1):t=vt.SubFetchAndRenderContent}this.addRiverSections(e);const i=this.getCurrentState().riverSectionFeedLayoutData.length-1,s=this.waitingAdsMap;if(s.has(i)||s.set(i,!0),t===vt.FirstFetchAndRenderContent){if(yield Object(mt.a)(),!this.previousRiverSectionContentResponse)return;this.fetchAndHandleSamAds(),this.config.isDisableAdsPrefetchFlight?window.addEventListener("scroll",this.onScroll):this.prefetchNextFeedAndAds()}else t===vt.SubFetchAndRenderContent?this.fetchAndHandleSamAds():t===vt.RenderContent&&this.updateNativeAdsInRiverSections()}))}renderNextFeedWithPrefetch(e){return Object(S.b)(this,void 0,void 0,(function*(){let t=vt.RenderContent;if(0===this.unRenderedLayoutTemplate.length){if(!(this.prefetchHandler?yield this.prefetchHandler:yield this.getContentForNextFeed(e)))return;this.isFirstFeedCall&&(t=vt.FirstFetchAndRenderContent,this.isFirstFeedCall=!1)}this.addRiverSections(e);const i=this.getCurrentState().riverSectionFeedLayoutData.length-1,s=this.waitingAdsMap;if(s.has(i)||s.set(i,!0),t===vt.FirstFetchAndRenderContent){if(yield Object(mt.a)(),!this.previousRiverSectionContentResponse)return;this.fetchAndHandleSamAdsWithPrefetch()}else t===vt.RenderContent&&this.updateNativeAdsInRiverSections();const n=this.config.numOfSectionsToPrefetch||2;this.unRenderedLayoutTemplate.length<=n&&!this.prefetchHandler&&(this.prefetchHandler=this.getContentForNextFeed().then(e=>{if(e)if(this.adServedCount<this.config.samAdNextPageUpperBound)if(this.config.isDisableAdsPrefetchFlight){const e=()=>{this.fetchAndHandleSamAdsWithPrefetch(!0),window.removeEventListener("scroll",e)};window.addEventListener("scroll",e)}else this.fetchAndHandleSamAdsWithPrefetch(!0);else this.fetchAndHandleSamAdsWithPrefetch();return this.prefetchHandler=void 0,e}).catch(()=>(this.prefetchHandler=void 0,!1)))}))}prefetchNextFeedAndAds(){return Object(S.b)(this,void 0,void 0,(function*(){this.riverAdRegionIndexList&&this.fetchAndHandleSamAds(!0);(yield this.getContentForNextFeed())&&this.fetchAndHandleSamAds(!0)}))}getContentForNextFeed(e){return Object(S.b)(this,void 0,void 0,(function*(){if(this.isFetchingContent)return!1;this.isFetchingContent=!0;const t=this.previousRiverSectionContentResponse;if(t&&t.status===je.a.NoContent)return this.isFetchingContent=!1,!1;const i=t&&t.nextPageRequest,s=yield this.fetchFeedContent(i,e?Ie.b.refresh:Ie.b.normal);if(this.isFetchingContent=!1,!s)return!1;if(this.previousRiverSectionContentResponse=s,s.status!==je.a.Success)return!1;const{sections:n}=s;for(const e of n){const{cards:t,layoutTemplate:i}=e;this.unRenderedRiverContent=this.unRenderedRiverContent.concat(t),this.unRenderedLayoutTemplate.push(i)}return this.updateAdRegionIndexList(),this.switchRedundantCmsAdsToNativeAds(),!0}))}generateAdRequest(){const{infoPaneAdRegionIndexList:e,riverAdRegionIndexList:t,infoPaneCmsAdRegionIndexList:i,riverCmsAdRegionIndexList:s,samAdsInitialUpperBound:n}=this;let a,r;return(e.length||t.length)&&(a={placements:[{region:"infopane",indices:e.splice(0)},{region:"river",indices:n>0?t.splice(0,n):t.splice(0)}]},this.samAdsInitialUpperBound=-1,this.config.enableInfopaneLeadgenNative&&a.placements.push({region:"resinfopane",indices:Array.from(i)}),this.config.enableRiverLeadgenNative&&a.placements.push({region:"resriver",indices:Array.from(s)})),(i.length||s.length)&&(r={placements:[{region:"infopane_cms",indices:i.splice(0)},{region:"river_cms",indices:s.splice(0)}]}),{samAdRequest:a,cmsAdRequest:r}}filterInfoPaneAds(e,t){return e?e.filter(e=>e.region===t).map(e=>(e.adLabelText=this.adLabelText,e.isGreyAdsLabelEnabled=this.isGreyAdsLabelEnabled,e.isWhiteSlug=this.config.isWhiteSlug,e.isTransparentSlug=this.config.isTransparentSlug,e.isNarrowTitleFooterGap=this.config.isNarrowTitleFooterGap,e)):[]}filterRiverAds(e,t){return e?e.filter(e=>e.region===t&&(e.items.length&&(this.config.useArticleCardTemplate?(e.items[0].imageWidth="388",e.items[0].imageHeight="225",e.imageWidth="388",e.imageHeight="225"):(e.items[0].imageWidth="300",e.items[0].imageHeight="156")),!0)).map(e=>(e.adLabelText=this.adLabelText,e.isGreyAdsLabelEnabled=this.isGreyAdsLabelEnabled,e.isProviderInHeader=this.config.isProviderInHeader,e.isProviderInFooter=this.config.isProviderInFooter,e.isWhiteSlug=this.config.isWhiteSlug,e.isTransparentSlug=this.config.isTransparentSlug,e)):[]}updateNativeAdsMap(e){this.infoPaneNativeAdsMap=this.infoPaneNativeAdsMap.concat(this.filterInfoPaneAds(e,"infopane")),this.infoPaneNativeAdsMap=this.infoPaneNativeAdsMap.concat(this.filterInfoPaneAds(e,"resinfopane")),this.riverNativeAdsMap=this.riverNativeAdsMap.concat(this.filterRiverAds(e,"river")),this.riverNativeAdsMap=this.riverNativeAdsMap.concat(this.filterRiverAds(e,"resriver"))}updateCmsNativeAdsMap(e){this.cmsInfopaneNativeAdsMap=this.cmsInfopaneNativeAdsMap.concat(this.filterInfoPaneAds(e,"infopane_cms")),this.cmsRiverNativeAdsMap=this.cmsRiverNativeAdsMap.concat(this.filterRiverAds(e,"river_cms"))}updateNativeAdsInRiverSections(){if(!(this.infoPaneNativeAdsMap.length>0||this.riverNativeAdsMap.length>0||this.cmsInfopaneNativeAdsMap.length>0||this.cmsRiverNativeAdsMap.length>0))return;const{riverSectionFeedLayoutData:e}=this.getCurrentState();if(e&&e.length){for(const[t]of e.entries()){if(!this.waitingAdsMap.get(t))continue;const i=e[t],s=[];let n=!1;i.cardMetadataList.forEach(e=>{if(e.type===ye.a.Infopane){const t=e;t.subItems.map((e,i)=>{e.type===ye.a.NativeAd&&this.isInvalidAdItem(e)?(t.subItems[i]=this.createNativeAdCardMetadata("infopane",e.regionIndex),this.isInvalidAdItem(t.subItems[i])&&(n=!0)):e.type===ye.a.CmsAd&&this.isInvalidAdItem(e)&&(t.subItems[i]=this.createNativeAdCardMetadata("infopane_cms",e.regionIndex),this.isInvalidAdItem(t.subItems[i])&&(n=!0))}),s.push(t)}else if(e.type===ye.a.NativeAd&&this.isInvalidAdItem(e)){const t=this.createNativeAdCardMetadata("river",e.regionIndex);s.push(t),this.isInvalidAdItem(t)&&(n=!0)}else if(e.type===ye.a.CmsAd&&this.isInvalidAdItem(e)){const t=this.createNativeAdCardMetadata("river_cms",e.regionIndex);s.push(t),this.isInvalidAdItem(t)&&(n=!0)}else s.push(e)}),n||this.waitingAdsMap.set(t,!1),e.splice(t,1,{feedData:this.mapFeedData(s,o.a[i.templateId],!0,this.riverSectionTelemetryObject),templateId:i.templateId,cardMetadataList:s})}window.requestAnimationFrame(()=>{setTimeout(()=>{const e=!0===he.b.IsPrerender?performance.now()-Object(G.g)(ve.d):performance.now();Object(G.o)(me.a.TimeToRenderAd,e)},0)}),X.setRiverSectionFeedLayoutData.getActionSender(this).send(e)}}isInvalidAdItem(e){return 0===e.placement.items.length}addRiverSections(e){return Object(S.b)(this,void 0,void 0,(function*(){if(!this.unRenderedLayoutTemplate.length)return[];let t=[];const i=this.unRenderedLayoutTemplate.shift(),s=o.a[i],n=this.getCardMetaDataForRiverSection(s);if(e){const e=n.findIndex(e=>e.type===ye.a.Infopane),a=n[e],r=n.findIndex(e=>e.type===ye.a.WeatherSummary),o=n[r],d=n.findIndex(e=>e.type===ye.a.StockQuote),c=n[d],l=n.findIndex(e=>e.type===ye.a.SportsMatch),u=n[l],p=n.findIndex(e=>e.type===ye.a.Trending),g=(n[p],[...n]);a&&g.splice(e,1,Object.assign(Object.assign({},a),{subItems:[a.subItems[0]]})),o&&g.splice(r,1,Object.assign(Object.assign({},o),{data:null})),c&&g.splice(d,1,Object.assign(Object.assign({},c),{data:null})),u&&g.splice(l,1,Object.assign(Object.assign({},u),{data:null}));const m=g.slice(13).map(e=>{const t=Object(_e.a)(e);return t.type!==ye.a.NativeAd&&Object.keys(t).forEach(e=>{"type"!==e&&"id"!==e&&(t[e]=null)}),t});g.splice(13,g.length-13+1,...m),t.push({feedData:this.mapFeedData(g,s,!0,this.riverSectionTelemetryObject),templateId:i,cardMetadataList:g}),X.setRiverSectionFeedLayoutData.getActionSender(this).send(t),bt[h.a.firstSectionRenderStart]=window.performance.now(),Object(Ce.j)().then(()=>Object(S.b)(this,void 0,void 0,(function*(){t=[],t.push({feedData:this.mapFeedData(n,s,!0,this.riverSectionTelemetryObject),templateId:i,cardMetadataList:n}),X.setRiverSectionFeedLayoutData.getActionSender(this).send(t),o&&(this.weatherDataConnector||(this.weatherDataConnector=yield this.rootReducer.getDataConnector(ge.a.WeatherData),this.setupWeatherDataObservers(),this.weatherDataConnector&&this.weatherDataConnector.getCurrentState()&&this.weatherDataConnector.getCurrentState().settingUpdateStatus&&(yield Object(Pe.d)(),this.mapSDCardDataToFeedLayout(ye.a.WeatherSummary))))})))}else{t.push({feedData:this.mapFeedData(n,s,!0,this.riverSectionTelemetryObject),templateId:i,cardMetadataList:n});const e=this.getCurrentState().riverSectionFeedLayoutData;X.setRiverSectionFeedLayoutData.getActionSender(this).send(e.concat(t)),bt[h.a.secondSectionRenderStart]=window.performance.now()}return n}))}mapFeedData(e,t,i,s){if(!e.length)return null;const n={cards:[],C5:[],C4:[],C3:[],C2:[],C1:[]},{cardSlots:a}=t;return e.forEach((e,t)=>{var r,o;const d=oe.a[e.type];if(!d)return;let c=null;if(d===ne.b.infopaneCard&&(c=this.setVisuallyReadyMarkers,this.visualReadinessCallbackSet=!0),!this.visualReadinessCallbackSet&&d===ne.b.contentCard){Object(se.a)(e)&&(c=this.setVisuallyReadyMarkers,this.visualReadinessCallbackSet=!0)}const l={cardMetadata:e,parentTelemetryObject:s,cardSlot:a[t],openLinksInNewTab:i,cardActionBitMask:this.config.cardActionBitMask||7,isAnaheimDesign:!0,cardActionClickHandler:this.cardActionClickHandler,goToPersonalizeCallback:this.goToPersonalizeCallback,initCardAction:this.initCardAction,visualReadinessCallback:c,localizedStrings:this.config.localizedStrings,configOptions:Object(_e.a)(this.config),stockImageData:this.config.stockImageData,sdCardActionClickHandler:this.clickSDCardActionButton,enableRichSocialReaction:this.config.enableRichSocialReactions,onReaction:this.onReaction,isAdFeedbackV1Enabled:!!this.config.adFeedbackV1Enabled,socialbarCommentsOnly:this.config.socialbarCommentsOnly,handleAdFeedbackSubmit:this.cardActionServiceClient.ReportAd.bind(this.cardActionServiceClient),activeItemChangedHandler:this.activeItemChangedHandler,isNarrowTitleFooterGap:this.config.isNarrowTitleFooterGap};let u;d===ne.b.contentCard&&(l.isProviderInFooter=this.config.isProviderInFooter),d===ne.b.infopaneCard&&(l.activeIndicator=!1,l.autoRotate=this.getCurrentState()&&this.getCurrentState().autoRotate,l.autoRotateIntervalMs=5e3,l.focusinHandler=this.focusinHandler,l.focusoutHandler=this.focusoutHandler,l.mouseenterHandler=this.mouseenterHandler,l.mouseleaveHandler=this.mouseleaveHandler,l.setAutoRotate=this.setAutoRotate,delete l.configOptions.useArticleCardTemplate),d===ne.b.moneyCard&&(l.cardStateData=this.getCurrentState()&&this.getCurrentState().moneyCardData,l.handleNavClick=this.handleNavClick,l.handleAddToWatchlist=this.handleAddToWatchlist,l.refreshMoneyCardData=this.refreshMoneyCardData,l.cardLayout=g.a.full),d===ne.b.shoppingCarouselCard&&(e.type===ye.a.ShoppingCard?l.configOptions=this.config.shoppingCardConfig:e.type===ye.a.ShoppingCarousel&&(l.configOptions=this.config.shoppingCarouselConfig)),d===ne.b.weatherCard&&(l.cardStateData=this.getCurrentState()&&this.getCurrentState().weatherCardData,l.saveSettingsAndRefresh=this.saveWeaSettingAndRefresh,l.triggerAutoSuggest=this.triggerWeatherLocAutoSuggest,l.cancelSettings=this.switchToWeatherForecast,l.selectLocationMode=this.selectWeatherLocationMode,l.selectWeatherUnit=this.selectWeatherUnit,l.selectValueFromSuggest=this.selectWeatherLocation,l.cardLayout="full",e&&e.data&&this.weatherDataConnector&&this.weatherDataConnector.updateWeatherDataState(e.data)),d===ne.b.serendipityCard&&(l.cardMetadata.search=this.recommendedSearchData,l.cardMetadata.trending=this.trendingNewsData),d===ne.b.horoscopeAnswerCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.horoscopeCard?(Object(pt.a)(this.config.childExperienceReferencesWC.horoscopeCard),l.configOptions=this.config.childExperienceReferencesWC.horoscopeCard):l.configOptions=null),d===ne.b.onThisDayCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.onThisDayCard?(Object(pt.a)(this.config.childExperienceReferencesWC.onThisDayCard),l.configOptions=this.config.childExperienceReferencesWC.onThisDayCard):l.configOptions=null),d===ne.b.electionsCard&&this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.electionsCard&&(Object(pt.a)(this.config.childExperienceReferencesWC.electionsCard),l.configOptions=this.config.childExperienceReferencesWC.electionsCard),d===ne.b.esportsCard&&this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.esportsCard&&(Object(pt.a)(this.config.childExperienceReferencesWC.esportsCard),l.configOptions=this.config.childExperienceReferencesWC.esportsCard),d===ne.b.coldStartCard&&(null===(o=null===(r=this.config.childExperienceReferencesWC)||void 0===r?void 0:r.coldStartWC)||void 0===o?void 0:o.displayType)===ze.c.Upsell&&(Object(pt.a)(this.config.childExperienceReferencesWC.coldStartWC.experience),l.upsellGetStartedClickHandler=this.initializeColdStartExperience);try{u=ne.a[d].getFeedDataForCard(l)}catch(t){let i=Xe[d];i||(i=d===ne.b.shoppingCarouselCard?e.type===ye.a.ShoppingCard?$.cg:$.qg:$.Uh),Object(_.c)(t,i,`${d} getFeedDataForCard error, ${t.toString()}`)}u&&Object.keys(u).forEach(e=>{n[e]=n[e].concat(u[e])})}),n}getCardMetaDataForRiverSection(e){const t=[];if(!e)return t;for(let i=0;i<e.cardCount;i++)t.push(this.unRenderedRiverContent.shift());return t}fetchFeedContent(e,t){return Object(S.b)(this,void 0,void 0,(function*(){let i;try{i=yield this.riverCardProvider.fetch(e,t)}catch(e){xe.a.sendAppErrorEvent(Object.assign(Object.assign({},$.Bb),{message:"Content fetch failed for Desktop Feed EdgeNext river section.",pb:Object.assign(Object.assign({},$.Bb.pb),{customMessage:"Failed with exception : "+e})}))}return i}))}generateNativeAdsResponse(e,t){const i=this.nativeAdService.updateSamAdResponse(e,t,this.config.adTemplateConfig),{placements:s,adLabelText:n,isGreyAdsLabelEnabled:a}=i;return this.adLabelText||(this.adLabelText="Ad"===e.adLabelText?n:e.adLabelText,this.isGreyAdsLabelEnabled=a),s.filter(e=>e.items.length)}updateAdRegionIndexList(){const{infoPaneAdRegionIndexList:e,riverAdRegionIndexList:t,infoPaneCmsAdRegionIndexList:i,riverCmsAdRegionIndexList:s}=this.previousRiverSectionContentResponse;this.infoPaneAdRegionIndexList.push(...e),this.riverAdRegionIndexList.push(...t),this.infoPaneCmsAdRegionIndexList.push(...i),this.riverCmsAdRegionIndexList.push(...s)}switchRedundantCmsAdsToNativeAds(){const{infoPaneAdRegionIndexList:e,riverAdRegionIndexList:t,infoPaneCmsAdRegionIndexList:i,riverCmsAdRegionIndexList:s}=this,{sections:n}=this.previousRiverSectionContentResponse,a=i.length-this.cmsAdsConfig.infoPaneIndices.length,r=s.length-this.cmsAdsConfig.riverIndices.length;if(a>0||r>0){Object(_.b)($.yb,"WPO response not matching CMS config");const o=[],d=[];n.forEach(e=>{e.cards&&e.cards.forEach(e=>{e.type===ye.a.Infopane?e.subItems.forEach(e=>{e.type===ye.a.CmsAd&&o.push(e)}):e.type===ye.a.CmsAd&&d.push(e)})});for(let t=0;t<a;t++)o[o.length-1-t].type=ye.a.NativeAd,e.push(i.pop());for(let e=0;e<r;e++)d[d.length-1-e].type=ye.a.NativeAd,t.push(s.pop());e.sort((e,t)=>e-t),t.sort((e,t)=>e-t)}}fetchSamAndCmsNativeAds(){return Object(S.b)(this,void 0,void 0,(function*(){const{samAdRequest:e,cmsAdRequest:t}=this.generateAdRequest(),[i,s]=yield Promise.all([this.fetchSamNativeAdsContent(e),this.fetchCmsAdsContent(t)]);return[i||[],s?s.placements:[]]}))}fetchAndHandleSamAdsWithPrefetch(e){return Object(S.b)(this,void 0,void 0,(function*(){const[t,i]=yield this.fetchSamAndCmsNativeAds();(t&&0!==t.length||i&&0!==i.length)&&(this.updateNativeAdsMap(t),this.updateCmsNativeAdsMap(i),this.updateNativeAdsInRiverSections(),t.forEach(({beaconsJson:t})=>{t&&(e&&void 0!==this.config.samAdNextPageUpperBound?this.adServedCount<this.config.samAdNextPageUpperBound?(this.beaconService.fireAdServedTrackingCall(t),this.adServedCount++):this.unServedSamAdSet.add(t):this.beaconService.fireAdServedTrackingCall(t))}))}))}fetchAndHandleSamAds(e){return Object(S.b)(this,void 0,void 0,(function*(){const[t,i]=yield this.fetchSamAndCmsNativeAds();if(t&&0!==t.length||i&&0!==i.length){this.updateNativeAdsMap(t),this.updateCmsNativeAdsMap(i),this.updateNativeAdsInRiverSections();let s=0;t.forEach(({beaconsJson:t})=>{t&&(e&&void 0!==this.config.samAdNextPageUpperBound?s<this.config.samAdNextPageUpperBound?(this.beaconService.fireAdServedTrackingCall(t),s++):this.unServedSamAdSet.add(t):this.beaconService.fireAdServedTrackingCall(t))})}}))}fetchCmsAdsContent(e){return Object(S.b)(this,void 0,void 0,(function*(){if(!e)return;let t;const i=new Promise((e,i)=>{t=e});let s;try{const i=this.cmsAdsConfig.infoPaneIndices.splice(0,e.placements[0].indices.length),n=this.cmsAdsConfig.riverIndices.splice(0,e.placements[1].indices.length),a=i.concat(n);s=yield this.nativeAdService.fetchCmsAds(e,this.cmsAdsConfig.documentId,a),!this.adLabelText&&s&&(this.adLabelText=s.adLabelText,this.isGreyAdsLabelEnabled=s.isGreyAdsLabelEnabled),Object(Ce.j)().then(()=>{t(s)})}catch(e){Object(_.c)(e,$.Ab,"Call to Cms Ad Service failed"),t()}return i}))}fetchSamNativeAdsContent(e){return Object(S.b)(this,void 0,void 0,(function*(){if(!e)return;let t;const i=new Promise((e,i)=>{t=e});try{let i;fe.a.startMark("AdServiceCall.DesktopFeedEdgeNext");let s=!1;this.isFirstBatchCall&&(i=[this.updateNativeAdsFromCmsCallback],s=!0,this.isFirstBatchCall=!1);const{placeHolderResponse:n,samResponse:a}=yield this.nativeAdService.fetchSamAds(e,s,i);Object(Ce.j)().then(()=>{t(this.generateNativeAdsResponse(n,a))})}catch(e){Object(_.c)(e,$.Ab,"Call to Ad Service failed"),t()}finally{fe.a.endMark("AdServiceCall.DesktopFeedEdgeNext")}return i}))}createNativeAdCardMetadata(e,t){let i,s,n=ye.a.NativeAd;switch(e){case"infopane":i=this.infoPaneNativeAdsMap.find(e=>e.regionIndex===t);break;case"river":i=this.riverNativeAdsMap.find(e=>e.regionIndex===t);break;case"infopane_cms":i=this.infoPaneNativeAdsMap.find(e=>e.regionIndex===t),s=this.cmsInfopaneNativeAdsMap.find(e=>e.regionIndex===t),i=i&&!i.isBackfill?i:s,n=ye.a.CmsAd;break;case"river_cms":i=this.riverNativeAdsMap.find(e=>e.regionIndex===t),s=this.cmsRiverNativeAdsMap.find(e=>e.regionIndex===t),i=i&&!i.isBackfill?i:s,n=ye.a.CmsAd}if(i){const{beaconsJson:s}=i;return s&&this.unServedSamAdSet.delete(s)&&this.beaconService.fireAdServedTrackingCall(s),{type:n,regionIndex:t,id:`nativead-${e}-${i.regionIndex}`,placement:i}}return{type:n,regionIndex:t,placement:{items:[]}}}saveWeaSettings(e){return Object(S.b)(this,void 0,void 0,(function*(){const t=[];return 3&e.changeSignal&&t.push(this.weatherPdpClient.updateUserSettings(1&e.changeSignal&&e.unitSet&&e.unitSet.toString(),2&e.changeSignal&&e.locationMode&&e.locationMode.toString())),e.selectedLocation&&e.locationMode==Ae.a.SpecifyLoc&&t.push(this.weatherPdpClient.setHomeLocation(e.selectedLocation)),yield Promise.all(t)}))}setupWeatherDataObservers(){Ve.a.updateWeatherSettings.registerObserver(()=>Object(S.b)(this,void 0,void 0,(function*(){yield Object(Pe.d)(),this.mapSDCardDataToFeedLayout(ye.a.WeatherSummary)})))}updateInitialRequest(){return Object.assign(Object.assign({},this.config.riverSectionCardProviderConfig),{initialRequest:Object.assign(Object.assign({},this.config.riverSectionCardProviderConfig.initialRequest),{feedId:this.feedId,feedName:this.feedName})})}revalidateExperienceStaleState(){var e,t;let i=36e5;return(null===(t=null===(e=this.config)||void 0===e?void 0:e.stalenessInfo)||void 0===t?void 0:t.staleThreshold)<1&&(i=60*this.config.stalenessInfo.staleThreshold*1e3),Object(G.g)(ve.d)>i?this.refreshFeed():this.refreshSDCards(),!0}refreshSDCards(){return Object(S.b)(this,void 0,void 0,(function*(){let e=this.getCurrentState().riverSectionFeedLayoutData;const t={};e.slice(0,2).forEach(e=>{e.cardMetadataList.forEach(e=>{e.type!==ye.a.WeatherSummary&&e.type!==ye.a.StockQuote&&e.type!==ye.a.SportsMatch||(t[Ke[e.type]]=e.type)})}),this.unRenderedRiverContent.forEach(e=>{e.type!==ye.a.WeatherSummary&&e.type!==ye.a.StockQuote&&e.type!==ye.a.SportsMatch||(t[Ke[e.type]]=e.type)});const i=yield this.SDCardProvider.fetch({contentType:Object.keys(t).join(",")});e=this.getCurrentState().riverSectionFeedLayoutData;const s=[...e];e.slice(0,2).forEach((e,n)=>{e.cardMetadataList.forEach((s,n)=>{if(Object.values(t).includes(s.type)){const t=i[Ke[s.type]].find(e=>e.type===s.type);e.cardMetadataList[n]=t}}),e=Object.assign(Object.assign({},e),{feedData:this.mapFeedData(e.cardMetadataList,o.a[e.templateId],!0,this.riverSectionTelemetryObject),cardMetadataList:e.cardMetadataList}),s.splice(n,1,e)}),X.setRiverSectionFeedLayoutData.getActionSender(this).send(s),this.unRenderedRiverContent.forEach((e,t)=>{if(e.type===ye.a.WeatherSummary||e.type===ye.a.StockQuote||e.type===ye.a.SportsMatch){const s=i[Ke[e.type]].find(t=>t.type===e.type);this.unRenderedRiverContent[t]=s}})}))}getInitialVisualState(){const e="visible"===document.visibilityState;return{isWindowFocused:e,isDocumentVisible:e,inViewport:!0}}setCmsConfig(){const e=this.config.cmsAds;e&&(this.cmsAdsConfig={documentId:e.documentId,infoPaneIndices:Array.from(e.infopane),riverIndices:Array.from(e.river)})}checkAwayTime(){const{idleTimeout:e}=this.config;if(!e||he.b.IsPrerender)return;(new Date).getTime()<this.awayTimestamp+e||(this.refreshFeed(),xe.a.sendPageView({page:{name:"IAR",isAutoRefresh:!0}}))}updateAwayTime(){this.awayTimestamp=(new Date).getTime()}}var yt=i("05Au");class St{reduce(e,t){if(!e)return{autoRotate:!1,coldStartFreResponse:void 0,isFocused:!1,moneyCardData:{},isMouseOver:!1,riverSectionFeedLayoutData:[]};if(!t)return e;let i,s=!1;return s=yt.a.handleAction(t,X.setAutoRotate,t=>{i=Object.assign(Object.assign({},e),{autoRotate:t})}),s=s||yt.a.handleAction(t,X.setIsFocused,t=>{i=Object.assign(Object.assign({},e),{isFocused:t})}),s=s||yt.a.handleAction(t,X.setIsMouseOver,t=>{i=Object.assign(Object.assign({},e),{isMouseOver:t})}),s=s||yt.a.handleAction(t,X.setRiverSectionFeedLayoutData,t=>{i=Object.assign(Object.assign({},e),{riverSectionFeedLayoutData:t})}),s=s||yt.a.handleAction(t,X.setWeatherCardData,t=>{i=Object.assign(Object.assign({},e),{weatherCardData:Object.assign(Object.assign({},e.weatherCardData),t)})}),s=s||yt.a.handleAction(t,X.setMoneyCardData,t=>{i=Object.assign(Object.assign({},e),{moneyCardData:Object.assign(Object.assign({},e.moneyCardData),t)})}),s=s||yt.a.handleAction(t,X.toggleSDCardActionsMenu,(t,s)=>{i=Object.assign(Object.assign({},e),{actionsMenuProps:t,actionsMenuOpen:s})}),s=s||yt.a.handleAction(t,X.setColdStartExperience,t=>{i=Object.assign(Object.assign({},e),{coldStartFreResponse:t})}),i||e}}var Ct=i("C8K2"),Ot=i("SP+O");const At=v.a.fiveColSupported(),wt=At?{[Object(c.e)(null,c.a.c2)]:{width:Ct.c+"px"},[Object(c.f)(c.a.c3)]:{width:Ct.d+"px"},[Object(c.f)(c.a.c4)]:{width:Ct.e+"px"},[Object(c.e)(c.a.c5,null)]:{width:Ct.f+"px"}}:{[Object(c.e)(null,c.a.c2)]:{width:Ct.c+"px"},[Object(c.f)(c.a.c3)]:{width:Ct.d+"px"},[Object(c.e)(c.a.c4,null)]:{width:Ct.e+"px"}},It=At?{[Object(c.e)(null,c.a.c2)]:{width:"300px"},[Object(c.f)(c.a.c3)]:{width:Ct.c+"px"},[Object(c.f)(c.a.c4)]:{width:Ct.d+"px"},[Object(c.e)(c.a.c5,null)]:{width:Ct.e+"px"}}:{[Object(c.e)(null,c.a.c2)]:{width:"300px"},[Object(c.f)(c.a.c3)]:{width:Ct.c+"px"},[Object(c.e)(c.a.c4,null)]:{width:Ct.d+"px"}},jt={desktopFeedEdgeNext_root:Object.assign({color:Ot.c,margin:"0 auto",position:"relative"},wt),desktopFeedEdgeNext_withRightRail:Object.assign({},It),feedSection:{display:"grid","flex-flow":"row wrap",gap:"12px","justify-content":"center","margin-bottom":"33px","--elevated-corner-radius":"6"},midGap:{gap:"10px!important"},miniGap:{gap:"4px!important"},tinyGap:{gap:"5px!important"},infopaneSentinel:{position:"absolute",width:"612px",height:"304px",top:"0",left:"0","z-index":"-1"},paginationSentinel:{bottom:"0",height:"1px",position:"absolute",width:"100%","z-index":"-1"}};var Tt=i("icPF");const Rt=Object(s.a)(jt)(J),Mt={reactComponent:Rt,experienceConfigSchema:Z.DesktopFeedEdgeNextConfigSchema,defaultMockState:n.mockDefaultState,mockState:n.mockState,mockConfig:Tt.mockConfig,inspector:Je.inspect}},icPF:function(e,t){},mEtE:function(e,t,i){"use strict";t.a=function(e){return e&&e.length?e[0]:void 0}},mJFi:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var s=i("HDSB"),n=i("D57K"),a=i("I6Lx"),r=i("ADRF"),o=i("tMmC"),d=i("X9Vi");class c{constructor(e,t,i=null){this.fetchImpl=e,this.config=t,this.xhrFetch=i,this.cfg=t||c.defaultConfig,this.cfg.appId=this.cfg.appId||c.defaultConfig.appId,this.cfg.num=this.cfg.num||c.defaultConfig.num}geocodeSuggestion(e){return Promise.resolve(null)}getAutoSuggestResponse(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=[{key:"appid",value:this.cfg.appId},{key:"mr",value:""+this.cfg.num},{key:"q",value:e},{key:"setmkt",value:!this.cfg.redirectZhCnJaJpMarket||"ja-jp"!==a.b.Locale&&"zh-cn"!==a.b.Locale?a.b.Locale:"en-us"},{key:"setlang",value:a.b.Locale},{key:"ul",value:a.b.ClientSettings?`${a.b.ClientSettings.geo_lat},${a.b.ClientSettings.geo_long},100`:""}];let i=[];if(!e||!e.trim||!e.trim().length)return i;const s=new URL(c.bingAutosuggestApi,c.bingAutoSuggestServiceHost);return s.search=r.a.keyValueArrayToQueryString(t),i=yield this.fetchImpl(s.href,{jsonpCallback:"cb"}).then(e=>e.json()).then(e=>this.getWeatherLocationFromResponse(e)).catch(e=>(o.a.log("failed: "+e),null)),i}))}getWeatherLocationFromResponse(e){const t=[];if(e&&e["@graph"]){const i=e["@graph"];for(let e=0;e<i.length;e++){const s=i[e];if(s){switch(s["b:stype"]){case"Island":case"PopulatedPlace":case"Postcode1":case"Other":{const e=s["s:address"]||{},i=s["s:geo"]||{},n=i["s:latitude"],r=i["s:longitude"];if("number"==typeof n&&"number"==typeof r){const i={locality:e["s:addressLocality"]||e["s:name"]||"",region:d.d.abbreviateUSState(e["s:addressRegion"]||"",a.b.Locale,e["b:countryIso"]||""),subRegion:e["b:addressSubregion"]||"",country:e["s:addressCountry"]||"",latitude:Number(n).toString(),longitude:Number(r).toString(),isoCode:e["b:countryIso"]||"",language:a.b.Locale};t.push(i)}}}}}}return t}getLocationSearchResponse(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=[{key:"appid",value:this.cfg.appId},{key:"locale",value:a.b.Locale},{key:"query",value:e}],i=[];if(!e||!e.trim||!e.trim().length)return i;const s=new URL(c.msnLocationSearchApi,c.msnApiServiceHost);s.search=r.a.keyValueArrayToQueryString(t);(new Headers).append("contentType","application/json");const n=yield(this.xhrFetch?this.xhrFetch:fetch)(s.href,{method:"GET",headers:{"Content-Type":"application/json"}});return n.ok||500===n.status?this.getweatherLocationFromSearchResponse(yield n.json()):null}))}isSameLocation(e,t){return e==t||null!=e&&null!=t&&(e.locationType==t.locationType&&(Math.abs(parseFloat(e.latitude)-parseFloat(t.latitude))<.001&&Math.abs(parseFloat(e.longitude)-parseFloat(t.longitude))<.001||(this.distance(e,t)<150||void 0)))}distance(e,t){const i=parseFloat(e.latitude)*Math.PI/180,s=parseFloat(e.longitude)*Math.PI/180,n=parseFloat(t.latitude)*Math.PI/180,a=n-i,r=parseFloat(t.longitude)*Math.PI/180-s,o=Math.sin(a/2)*Math.sin(a/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(i)*Math.cos(n);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}getweatherLocationFromSearchResponse(e){if(!(e.value&&e.value[0]&&e.value[0].responses&&e.value[0].responses[0]))return[];const t=e.value[0].responses[0];if(t.error)return[];const i=t.locations.filter(e=>("admindivision1"!==e.entityType.toLowerCase()||"jp"===e.countryCode.toLowerCase())&&e.coordinates&&e.coordinates.lat&&e.coordinates.lon).map(e=>({isoCode:e.countryCode,locality:e.locality,region:e.state||e.adminDistrict,country:e.countryRegion,latitude:e.coordinates.lat.toString(),longitude:e.coordinates.lon.toString(),displayName:e.displayName})),s=[];return i.forEach(e=>{0==s.map(t=>this.isSameLocation(t,e)).filter(e=>e).values.length&&s.push(e)}),s}populateSearchMoreResponse(){}}c.bingAutoSuggestServiceHost="https://platform.bing.com",c.bingAutosuggestApi="geo/AutoSuggest/v1",c.defaultConfig={num:4,appId:"C98EA5B0842DBB9405BBF071E1DA76512D21FE36"},c.msnLocationSearchApi="/v0/weather/locations/search",c.msnApiServiceHost="https://api.msn.com";var l=i("qE0w");class u{constructor(e,t,i,s,n,a,r,o){this.fetchImpl=e,this.host=t,this.api=i,this.appId=s,this.excludeSubTypes=n,this.includeSubTypes=a,this.escapeISO=r,this.flightId=o,this.filterSuggestion=e=>-1===this.excludeSubTypes.indexOf(e.subType)&&(-1!==this.escapeISO.indexOf(e.address&&e.address.countryIso&&e.address.countryIso.toLowerCase())||-1!==this.includeSubTypes.indexOf(e.subType)),this._parseLocationFromAS=!0}addExtraASParams(e,t){return e}_getDefaultSuggestions(){return[]}getSuggestions(e){return Object(n.b)(this,void 0,void 0,(function*(){if(e.disableThisRequest)return null;if((!e.searchText||""===e.searchText.trim())&&(e.disableFavorites||!this._useFavoriteSuggestions)){let e=this._getDefaultSuggestions();const t=this.getHistorySuggestions();e=this._combineSuggestions(t,e),this._updateSuggestionsRank(e);return{suggestions:e}}const t=this._constructASRequestUrl(e);return this.fetchImpl(t.href).then(e=>e.json()).then(t=>{const i=this._parseSuggestionsV6(t),s=this.getHistorySuggestions(e.searchText),n=e.searchText&&""!==e.searchText.trim()?[]:this._getDefaultSuggestions();return i.suggestions=this._combineSuggestions(i.suggestions,s),i.suggestions=this._combineSuggestions(i.suggestions,n),this._updateSuggestionsRank(i.suggestions),i}).catch(e=>null)}))}getHistorySuggestions(e){return[]}_constructASRequestUrl(e){const t=[{key:"appid",value:this.appId},{key:"count",value:""+e.maxResults},{key:"q",value:e.searchText},{key:"localcircularview",value:e.userLocation&&e.userLocation+",100"},{key:"setmkt",value:a.b.Locale},{key:"setlang",value:a.b.Locale},{key:"types",value:e.suggestionTypes||""},{key:"abbrtext",value:e.abbrSuggestions?"1":""},{key:"structuredaddress",value:"true"},{key:"setflight",value:this.flightId}],i=new URL(this.api,this.host);return i.search=r.a.keyValueArrayToQueryString(t),i}_combineSuggestions(e,t){let i=[];if(t&&t.length){i=t;let s=!1;for(let n=0;n<e.length;n++){e[n].root;const a=e[n].address,r=a&&a.streetAddress,o=a&&a.addressLocality,d=e[n].name;for(let e=0;e<t.length;e++){const i=t[e];if(r&&i.formatedAddress&&i.formatedAddress.indexOf(r)>-1&&(o&&i.formatedAddress.indexOf(o)>-1||d&&i.title&&i.title.indexOf(d)>-1)){s=!0;break}}s?s=!1:i.push(e[n])}}else i=e;return i}_updateSuggestionsRank(e){for(let t=0;t<e.length;t++)e[t].suggestionRank=t}_parseSuggestionsV6(e){const t={},i=[];if(e){const s=e.instrumentation;t.formattingRules=this._createFormattingRulesV6(e.formattingRules);const n=this._getDefaultFormattingRuleV6(t.formattingRules),r=e.value;for(let e=0;e<r.length;e++){const o={},c=r[e];try{o.root=c,o.type=c._type,o.readLink=c.readLink,o.readLinkPingSuffix=c.readLinkPingSuffix,o.instrumentationInfo=s,o.suggestionRank=e,o.formattingRuleId=c.formattingRuleId,o.formattingRule=o.formattingRuleId&&t.formattingRules[o.formattingRuleId]||n,o.entityId=c.id,o.name=c.name,o.query=c.query;const r=c.categories;o.primaryCategoryPath=r&&r.length&&r[0],o.entityId&&0===o.entityId.indexOf("local_geoid")&&(o.geoId=o.entityId,o.entityId="");const l=c.entityPresentationInfo;l&&l.entitySubTypeHints&&l.entitySubTypeHints.length&&(o.subType=l.entitySubTypeHints[0]);const u=c.geo;if(u&&this._parseLocationFromAS){const e=u.latitude,t=u.longitude;e&&t&&(o.location={latitude:e,longitude:t})}c.address?(o.address=c.address,o.address.addressRegion=d.d.abbreviateUSState(o.address.addressRegion,a.b.Locale,o.address.countryIso)):c.location&&c.location.length?o.address=c.location[0].address:"PostalAddress"===o.type&&(o.address=c),"Favorite"==o.type&&(o.alternateName=c.alternateName,o.subType=c.subType,this._processFavoriteItemId(c,o)),i.push(o)}catch(e){}}}return t.suggestions=i.filter(this.filterSuggestion),t}_createFormattingRulesV6(e){const t={};if(e)for(let i=0;i<e.length;i++){const s=JSON.parse(e[i]);t[s.identifier]=s}return t}_getDefaultFormattingRuleV6(e){let t=e&&e.Default||null;for(const i in e){t||(t=e[i]);if(a.b.Locale.indexOf(i.toLowerCase())>-1){t=e[i];break}}return t}_processFavoriteItemId(e,t){const i=e.bingId;!i||0!==i.indexOf("local_ypid:")&&0!==i.indexOf("sid")&&0!==i.indexOf("local_vdpid")||(t.entityId=i),t.bingId=i}}u.autosuggestCallerId="autosug";class h{constructor(e){this.suggestion=e,this._formatSuggestion(this.suggestion),this.setSimpleSearchText(),this._setDisplayName()}_setDisplayName(){const e=this._formattingRule&&this._formattingRule["b:groupSeparator"]||", ";this.suggestionTextLine2?this.suggestion.displayName=this.suggestionTextLine1+e+this.suggestionTextLine2:this.suggestion.displayName=this.suggestionTextLine1}setSimpleSearchText(){const e=this._formattingRule&&this._formattingRule["b:groupSeparator"]||", ";if("Favorite"===this.suggestion.type){const t=this.suggestion,i=t.name,s=t.address&&t.address.streetAddress;this._searchText=i!==s&&s?i+e+s:i}else this.suggestionTextLine2?this._searchText=this.suggestionTextLine2+e+this.suggestionTextLine1:this._searchText=this.suggestionTextLine1;this.suggestion&&(this.suggestion.searchText=this._searchText)}_removeCountry(e){let t=", ";this._formattingRule&&(t=this._formattingRule["b:groupSeparator"]||this._formattingRule.groupSeparator||", ");const i=this.suggestion.address||this.suggestion.root,s=i&&i.addressCountry;if(s&&e&&e.slice(e.length-s.length)===s){const i=e.slice(0,e.length-s.length);return i.slice(i.length-t.length)===t?i.slice(0,i.length-t.length):i}return e}_formatSuggestion(e){const t=this.suggestion.formattingRule,i=e;if("Favorite"===e.type)return i.alternateName?this.suggestionTextLine1=i.alternateName:this.suggestionTextLine1=i.name,this.suggestionTextLine2=i.address&&i.address.streetAddress,this.suggestion.formatedAddress=i.address&&i.address.streetAddress,void(this.suggestion.title=i.name);i.name&&(this.suggestionTextLine1=i.name,e.title=i.name),i.query&&(this.suggestionTextLine1=i.query),t?(this._formattingRule=t,this.suggestion.address?this._applyFormattingRule(this.suggestion.address):this._applyFormattingRule(e.root)):(this.suggestionTextLine1=e.title,this.suggestionTextLine2=e.formatedAddress),this.suggestion.formatedLine1=this.suggestionTextLine1,this.suggestion.formatedLine2=this.suggestionTextLine2,this.suggestion.formatedLine2WithoutCountry=this._removeCountry(this.suggestionTextLine2)}_applyFormattingRule(e){let t=0;const i=this._formattingRule["b:fieldGroups"]||this._formattingRule.fieldGroups;if(!this.suggestionTextLine1)for(;t<i.length;t++){const s=this._getFormattedGroupString(e,i[t]);if(s){this.suggestionTextLine1=s,this.suggestion.title=s,++t;break}}const s=[];for(;t<i.length;t++){const n=this._getFormattedGroupString(e,i[t]);n&&s.push(n)}const n=this._formattingRule["b:groupSeparator"]||this._formattingRule.groupSeparator||", ";this.suggestionTextLine2=s.join(n),this.suggestion.formatedAddress=this.suggestionTextLine2}_getFormattedGroupString(e,t){const i=[];let s;const n=t.fields;for(let t=0;t<n.length;t++)s=this._getPrimaryField(e,n[t]),s||(s=this._getAlternateField(e,n[t])),s&&i.push(s);const a=t.fieldSeparator||" ";return i.join(a)}_getPrimaryField(e,t){let i;return e&&t&&(i=e[t.name]),i}_getAlternateField(e,t){let i;if(e&&t){const s=t.alternateField;if(s){const t=s.split(",");for(let s=0;s<t.length&&(i=e[t[s]],!i);s++);}}return i}}h.HistorySuggestionType="history";class p{constructor(e,t){this.key=e,this.fetchImpl=t,this.geocode=(e,t,i,s,o)=>Object(n.b)(this,void 0,void 0,(function*(){const n={success:!1,statusCode:null,authenticationResultCode:null,statusDescription:null,name:e,results:null};if(!location)return null;const d=i&&i<=p._maxNumberOfResults?i:p._defaultResultCount,c=[{key:"key",value:this.key},{key:"maxResults",value:""+d},{key:"q",value:encodeURIComponent(e)},{key:"inclnb",value:s?"1":"0"},{key:"incl",value:o?"ciso2":""},{key:"userMapView",value:p._getBoundsString(t)},{key:"culture",value:a.b.Locale}],l=new URL(p.geoApi,p.geoHost);return l.search=r.a.keyValueArrayToQueryString(c),this.fetchImpl(l.href).then(e=>e.json()).then(e=>{if(e&&e.authenticationResultCode===p._validAuthenticationCode&&e.statusCode===p._validStatusCode&&e.statusDescription===p._validStatusDescription&&e.resourceSets&&0!==e.resourceSets.length){let t;n.success=!0,n.statusCode=p._validStatusCode,n.authenticationResultCode=p._validAuthenticationCode,n.statusDescription=p._validStatusDescription;for(let i=0,s=e.resourceSets.length;i<s;i++)if(t=e.resourceSets[i].resources,t&&0!==t.length){n.results=t;break}n.traceId=e.traceId}else e?(n.statusCode=e.statusCode,n.authenticationResultCode=e.authenticationResultCode,n.statusDescription=e.statusDescription,n.errorMessage=e.errorDetails&&e.errorDetails.length>0&&e.errorDetails[0],n.traceId=e.traceId):(n.statusCode=400,n.authenticationResultCode="Unknown",n.statusDescription="Unknown");return n}).catch(e=>(n.authenticationResultCode="Unknown",n.statusCode=404,n.statusDescription="Http Error",n))}))}static _getBoundsString(e){return e?e.south+","+e.west+","+e.north+","+e.east:""}}p._validAuthenticationCode="ValidCredentials",p._validStatusCode=200,p._validStatusDescription="OK",p._defaultResultCount=5,p._maxNumberOfResults=20,p.geoHost="https://dev.virtualearth.net",p.geoApi="/REST/v1/Locations";class g{constructor(e,t,i=null,s=null){this.fetchImpl=e,this.userLocation=i,this.xhrFetch=s,this._translateSuggestion=e=>{const t=e.suggestion.address||e.suggestion.root,i=e.suggestion.location,s=i&&i.latitude,n=i&&i.longitude;if(this.cfg.notFollowFormatRule){const i={language:a.b.Locale,addressLine:e.suggestion.name||(null==t?void 0:t.streetAddress),locality:null==t?void 0:t.addressLocality,region:null==t?void 0:t.addressRegion,subRegion:null==t?void 0:t.addressSubregion,country:t&&(t.addressCountry||""),latitude:s&&Number(s).toString(),longitude:n&&Number(n).toString(),typeV6:e.suggestion.type,searchText:e.suggestion.searchText,formatedAddress:e.suggestion.formatedAddress,readLink:e.suggestion.readLink,isoCode:t&&(t.countryIso||"")};return i.displayName=l.formatLocation(i),i.firstLine=l.getAutoSuggestLocationFirstLine(i),i.secondLine=l.getAutoSuggestLocationSecondLine(i),i}return{language:a.b.Locale,locality:e.suggestion.formatedLine1,region:e.suggestion.formatedLine2WithoutCountry,country:t&&(t.addressCountry||""),latitude:s&&Number(s).toString(),longitude:n&&Number(n).toString(),typeV6:e.suggestion.type,searchText:e.suggestion.searchText,formatedAddress:e.suggestion.formatedAddress,readLink:e.suggestion.readLink,isoCode:t&&(t.countryIso||"")}},this.cfg=Object.assign(Object.assign({},g.defaultConfig),t||{}),"CN"==(null==i?void 0:i.isoCode)&&(this.cfg.endpoint="https://cn.bing.com"),this._extraResult=this.cfg.latinPercentageLimit>0?5:0,this._geocoder=new p(this.cfg.geocoderKey,e),this.cfg.escapeISO=this.cfg.escapeISO.map(e=>e.toLowerCase()),this._autoSuggestModel=new u(e,this.cfg.endpoint,g.bingAutosuggestApi,this.cfg.appId,this.cfg.excludeSubTypes,this.cfg.includeSubTypes,this.cfg.escapeISO,this.cfg.flightId)}getLocationSearchResponse(e){return Promise.resolve(null)}getAutoSuggestResponse(e){var t,i,s;return Object(n.b)(this,void 0,void 0,(function*(){if(e){const n="zh-cn"===(null===(t=null===a.b||void 0===a.b?void 0:a.b.Locale)||void 0===t?void 0:t.toLowerCase())&&"zh"!==(null===(s=null===(i=null===a.b||void 0===a.b?void 0:a.b.ClientSettings)||void 0===i?void 0:i.geo_country)||void 0===s?void 0:s.toLowerCase())?"40,116":this.userLocation&&`${this.userLocation.latitude},${this.userLocation.longitude}`,r={searchText:e,maxResults:this.cfg.num+this._extraResult,userLocation:n,suggestionTypes:this.cfg.suggestionTypes,abbrSuggestions:!0,localMapView:null},o=yield this._autoSuggestModel.getSuggestions(r);return this._parseSuggestions(o)}}))}_latinPercentage(e){const t=e.locality+e.country+e.region+e.subRegion;if(!t)return 0;return t.match(g.latinParttern).join("").length/t.length}_parseSuggestions(e){const t=[],i=e.suggestions;if(i.length>0)for(let e=0;e<i.length;e++)t.push(this._getSuggestionResult(i[e]));let s=t.map(this._translateSuggestion);return this.cfg.latinPercentageLimit>0&&(s=s.filter(e=>this._latinPercentage(e)>this.cfg.latinPercentageLimit).slice(0,this.cfg.num)),s=s.filter(e=>l.isValidLocationToSuggest(e)),s}_getSuggestionResult(e){return new h(e)}_getLatLongFromReadLink(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!e.readLink)return null;const t=[{key:"appid",value:this.cfg.appId}],i=new URL(e.readLink);return i.search=r.a.keyValueArrayToQueryString(t),this.fetchImpl(i.href).then(e=>e.json()).then(t=>{const i=t.geo;if(i&&i.latitude&&i.longitude)return Object.assign(Object.assign({},e),{latitude:i.latitude.toString(),longitude:i.longitude.toString()})}).catch(e=>null)}))}geocodeSuggestion(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=e;if(t.longitude&&t.latitude)return t;const i=yield this._getLatLongFromReadLink(e);if(i)return i;const s=this._getSuggestionAddress(t);return this._geocoder.geocode(s,null,1).then(e=>{if(e.success&&e.results&&e.results.length>0){const i=e.results[0];i.bbox;if(i.point){const e=i.point.coordinates;return t.latitude=e[0].toString(),t.longitude=e[1].toString(),t}}return null})}))}_getSuggestionAddress(e){return e&&"LocalBusiness"===e.typeV6&&e.formatedAddress?e.formatedAddress:e&&e.searchText}}g.bingAutosuggestApi="/api/v6/Places/AutoSuggest",g.defaultConfig={num:5,appId:"D41D8CD98F00B204E9800998ECF8427E1FBE79C2",geocoderKey:"AnTcaqBi2ypp0xI-OZNi4W_ik2KhjgpqioTAtXLC8GzkMBQRMlyxvxyTnd5b73im ",suggestionTypes:"",endpoint:"https://www.bing.com",excludeSubTypes:["CountryRegion","AdminDivision1"],includeSubTypes:["PopulatedPlace","AdminDivision2"],escapeISO:["us"],flightId:""},g.latinParttern=/[\p{Script=Latin}\p{White_Space}\p{Sc}\p{P}\p{Number}]+/gu;var m=i("5xIM"),b=i.n(m);function v(e){if(e&&e.useV6){const t=Object(s.a)()?window.fetch.bind(window):fetch;return new g(t,e,d.b.headLocation())}return new c(b.a,e)}},mOQN:function(e,t,i){"use strict";var s=i("oKML"),n=i("FoV5");t.a=function(e){return null==e?[]:Object(s.a)(e,Object(n.a)(e))}},mXQk:function(e,t,i){"use strict";i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return d}));const s={ColdStart:"ColdStart",UpsellGetStartedButton:"GetStarted"},n="cold-start-close",a="cold-start-confirm",r="cold-start-selection-done",o={Article:{width:148,height:108},Provider:{width:100,height:100},Topic:{width:200,height:200}},d=10},oKML:function(e,t,i){"use strict";var s=i("mr4r");t.a=function(e,t){return Object(s.a)(t,(function(t){return e[t]}))}},pMIE:function(e,t,i){"use strict";var s=i("/XsO"),n=i("eupA");var a=function(e){return Object(n.a)(Object(s.a)(e))},r=i("mOQN");var o=function(e){return Object(n.a)(Object(r.a)(e))},d=i("SEb4");t.a=function(e){return(Object(d.a)(e)?a:o)(e)}},rFwl:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var s=i("OOuA"),n=i("7nmT"),a=i.n(n),r=i("wirn"),o=i("1I/+"),d=i("Gy7L"),c=i("qibw"),l=i("OnwC"),u=i("Sunj"),h=i("pH9t"),p=i("nSud"),g=i("L1Sn");u.a,h.a,p.a;class m extends l.a{constructor(e){super(e),this.handledProps={managedClasses:void 0,menuItems:void 0,onDismiss:void 0,referrerButton:void 0,requestContext:void 0,overrideStyles:void 0},this.determinePosition=()=>{const{referrerButton:e}=this.props;if(e){const{top:t,left:i,width:s}=e.getBoundingClientRect();return{top:t+window.scrollY,left:i+window.scrollX,offset:s}}return{top:window.scrollY,left:window.scrollX,offset:0}},this.menuItemKeyDown=e=>{e.keyCode===d.g&&this.props.menuItems.find(t=>t.id===e.currentTarget.id).onClick(e)},this.keyDownHandler=e=>{const{referrerButton:t,onDismiss:i}=this.props;e.keyCode===d.h?(t&&t.focus(),i&&i()):this.tabEventHandler(e)},this.tabEventHandler=e=>{const{referrerButton:t,onDismiss:i}=this.props,s=a.a.findDOMNode(this);e.keyCode===d.m&&t&&s.contains(document.activeElement)&&(t.focus(),i&&i(),e.preventDefault())},this.state={width:0,height:0}}componentDidMount(){const e=a.a.findDOMNode(this);this.setState({width:e.offsetWidth,height:e.offsetHeight}),this.firstMenuItemRef&&this.firstMenuItemRef.focus()}componentWillUnmount(){const e=document.getElementsByClassName(this.props.managedClasses.menuItem);Array.from(e).forEach(e=>{g.a.get(e).isCaptured=!1})}render(){return Object(s.a)("div",Object.assign({onKeyDown:this.keyDownHandler,tabIndex:-1,style:Object.assign(Object.assign({},this.getPlacementStyle(document.dir)),{position:"absolute"})},this.unhandledProps(),{className:this.props.managedClasses.menu}),Object(s.a)(u.a,null,this.renderActionsMenuSectionItems()))}renderActionsMenuSectionItems(){const{menuItems:e}=this.props,t={marginTop:0,marginBottom:"6px"};return e.map((e,i)=>e.isDivider?Object(s.a)(p.a,{style:t}):Object(s.a)(h.a,Object.assign({ref:e=>this.firstMenuItemRef=this.firstMenuItemRef||e,role:"menuitem",key:"ccaitem-"+i},e.telemetryTags,{onClick:e.onClick,onKeyDown:this.menuItemKeyDown,id:e.id,tabIndex:0,class:this.props.managedClasses.menuItem}),e.glyph&&Object(s.a)(r.a,{glyphType:e.glyph,slot:"start"}),Object(s.a)("span",{"aria-label":e.title},e.title)))}getPlacementStyle(e){const{width:t,height:i}=this.state;let s,n,a;const{referrerButton:r}=this.props;if(r){const e=this.determinePosition();s=e.left,n=e.top+e.offset+document.body.scrollTop,a=e.offset}if(!t)return{top:n,left:window.scrollX};const d=Object(o.b)(this.props.requestContext.data.innerWidth,"innerWidth"),c=window.document&&window.document.documentElement&&window.document.documentElement.offsetHeight+document.body.scrollTop;if(c&&n+i>c){if(n-i-a<0)return this.getHorizontallyPlacedStyle(e,s,n,a,d,c,t,i);n=n-i-a}const l={top:n,left:Math.max(s-t+a,.5*a)},u={top:n,left:s};return this.getPrioritizedFittingPosition(e,[l,u],t,d,a)}getPrioritizedFittingPosition(e,t,i,s,n){const[a,r]=e===c.a.rtl?t:[t[1],t[0]],o=a.left+i<s,d=r.left+i<s;if(o)return a;if(!o&&d)return r;{const i={top:t[0].top};return e===c.a.rtl?i.right=.5*n:i.left=.5*n,i}}getHorizontallyPlacedStyle(e,t,i,s,n,a,r,o){i-s+o<=a?i-=s:i-o>=0?i-=o:i=i-.5*s<.5*a?.5*s:a-.5*s-o;const d={top:i,left:t+s},c={top:i,left:t-r};return this.getPrioritizedFittingPosition(e,[c,d],r,n,s)}}const b={menu:{display:"inline","animation-duration":"0.367s","animation-fill-mode":"both","animation-name":"fadeIn, slideIn","animation-timing-function":"cubic-bezier(0.1, 0.9, 0.2, 1)","border-radius":"4px","box-shadow":"0 2.4px 7.2px rgba(0, 0, 0, 0.18), 0 12.8px 28.8px rgba(0, 0, 0, 0.22)","max-width":"275px","min-width":"240px",overflow:"hidden",position:"absolute","z-index":""+i("0fst").a.Flyout,"&:focus":{outline:"none"},"& fluent-menu-item::part(content)":{width:"100%"}},"@keyframes fadeIn":{from:{opacity:0},to:{opacity:1}},"@keyframes slideIn":{from:{transform:"translate3d(0px, -10px, 0px)"},to:{transform:"translate3d(0px, 0px, 0px)"}},menuItem:{"grid-template-columns":"32px auto"}};var v=i("+viU");const f=Object(v.a)(b)(m)},rGfm:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("G82u");class n{}n.refreshRiver=new s.a("RiverRefresh"),n.repaintRiver=new s.a("RiverRepaint"),n.riverRefreshed=new s.a("RiverRefreshed"),n.riverQueryUpdated=new s.a("RiverQueryUpdated"),n.riverLocationUpdated=new s.a("RiverLocationUpdated")},"uZl+":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a}));var s=i("Am8i");const n={cancelTelemetryName:"Cancel",cardActionV2TelemetryName:"Card Action Ellipses",closeHeadlineTelemetryName:"Close dialog",closeModuleTelemetryName:"Dismiss",copyTelemetryName:"Copy",hideMenuItemTelemetryName:"Hide",hideHeadlineTelemetryName:"Hide Story",muteMenuItemTelemetryName:"MutePublisher",muteButtonTelemetryName:"Mute",muteConfirmationTelemetryName:"Hide Stories from Publisher",reportButtonTelemetryName:"Submit",reportCheckedTelemetryName:"Checked",reportDialogTelemetryName:"ReportedReason",reportHeadlineTelemetryName:"Report an issue",reportMenuItemTelemetryName:"ReportArticle",reportUncheckedTelemetryName:"Unchecked",reportDialogFeedbackTextTelemetryName:"Feedback",reportDialogPrivacyStatementTelemetryName:"Privacy Statement",saveMenuItemTelemetryName:"Save",showFewerHeadlineTelemetryName:"Fewer stories like this",showFewerMenuItemTelemetryName:"showFewer",showMoreHeadlineTelemetryName:"More stories like this",showMoreMenuItemTelemetryName:"showMore",shareArticleTelemetryName:"ShareArticle",shareDialogTelemetryName:"Share"};class a{constructor(e){if(this.componentRoot=e,this.mapSocialMediaShareIconTelemetry=(e,t,i,n={})=>(this.socialMediaShareIconTelemetryObjects[e]=this.shareDialogTelemetryObject.addOrUpdateChild({name:t,behavior:s.b.Navigate,action:s.a.Click,content:Object.assign(Object.assign({},n),{headline:i})},this.socialMediaShareIconTelemetryObjects[e]),this.socialMediaShareIconTelemetryObjects[e]),this.mapMenuItemTelemetry=(e,t,i,s,n,a)=>{if(this.componentRoot)return this.menuItemsTelemetryObjects[e]=this.componentRoot.addOrUpdateChild({name:e,type:t,behavior:i,content:Object.assign(Object.assign({},a),{headline:s||e,id:n})},this.menuItemsTelemetryObjects[e]),this.menuItemsTelemetryObjects[e]},this.mapReportDialogOptionsTelemetry=(e,t,i,n)=>(this.reportDialogOptionsTelemetryObjects[e]=this.reportDialogTelemetryObjects.dialogTelemetryObject.addOrUpdateChild({name:t,behavior:s.b.Report,type:s.e.ActionButton,action:s.a.Click,content:{headline:i,id:n,type:s.c.Article}},this.reportDialogOptionsTelemetryObjects[e]),this.reportDialogOptionsTelemetryObjects[e]),!e)return;const t=e.contract.content||{},i=this.componentRoot.addOrUpdateChild({name:n.muteConfirmationTelemetryName,type:s.e.Interaction,behavior:s.b.Mute,content:Object.assign(Object.assign({},t),{headline:n.muteButtonTelemetryName}),action:s.a.View});this.muteDialogTelemetryObjects={dialogTelemetryObject:i,cancelButtonTelemetryObject:i.addOrUpdateChild({name:n.cancelTelemetryName,behavior:s.b.MuteCancel,content:Object.assign(Object.assign({},t),{headline:n.cancelTelemetryName})}),closeButtonTelemetryObject:i.addOrUpdateChild({name:n.closeModuleTelemetryName,behavior:s.b.Close,content:Object.assign(Object.assign({},t),{headline:n.closeHeadlineTelemetryName})}),actionButtonTelemetryObject:i.addOrUpdateChild({name:n.muteButtonTelemetryName,behavior:s.b.Mute,content:Object.assign(Object.assign({},t),{headline:n.hideMenuItemTelemetryName})})};const a=this.componentRoot.addOrUpdateChild({name:n.reportDialogTelemetryName,type:s.e.Interaction,behavior:s.b.Report,content:Object.assign(Object.assign({},t),{headline:n.reportHeadlineTelemetryName}),action:s.a.Click});this.reportDialogTelemetryObjects={dialogTelemetryObject:a,cancelButtonTelemetryObject:a.addOrUpdateChild({name:n.cancelTelemetryName,behavior:s.b.Cancel,content:Object.assign(Object.assign({},t),{headline:n.cancelTelemetryName})}),closeButtonTelemetryObject:a.addOrUpdateChild({name:n.closeModuleTelemetryName,behavior:s.b.Close,content:Object.assign(Object.assign({},t),{headline:n.closeHeadlineTelemetryName})}),actionButtonTelemetryObject:a.addOrUpdateChild({name:n.reportButtonTelemetryName,behavior:s.b.Mute,content:Object.assign(Object.assign({},t),{headline:n.reportButtonTelemetryName})})},this.shareDialogTelemetryObject=this.componentRoot.addOrUpdateChild({name:n.shareDialogTelemetryName,type:s.e.Interaction,behavior:s.b.Share,content:Object.assign(Object.assign({},t),{headline:n.shareDialogTelemetryName}),action:s.a.Click}),this.articleShareTelemetryObject=this.shareDialogTelemetryObject.addOrUpdateChild({name:n.shareArticleTelemetryName,type:s.e.Headline,behavior:s.b.Navigate,content:Object.assign(Object.assign({},t),{headline:n.shareArticleTelemetryName})}),this.closeShareButtonTelemetryObject=this.shareDialogTelemetryObject.addOrUpdateChild({name:n.closeModuleTelemetryName,behavior:s.b.Close,action:s.a.Click,content:Object.assign(Object.assign({},t),{headline:n.closeHeadlineTelemetryName})}),this.copyShareButtonTelemetryObject=this.shareDialogTelemetryObject.addOrUpdateChild({name:n.copyTelemetryName,behavior:s.b.Share,action:s.a.Click,content:Object.assign(Object.assign({},t),{headline:n.copyTelemetryName})}),this.socialMediaShareIconTelemetryObjects={},this.menuItemsTelemetryObjects={},this.reportDialogOptionsTelemetryObjects={},this.reportDialogFeedbackTextTelemetryObject=a.addOrUpdateChild({name:n.reportDialogFeedbackTextTelemetryName,type:s.e.ActionButton,behavior:s.b.Report,action:s.a.Click,content:Object.assign(Object.assign({},t),{headline:n.reportDialogFeedbackTextTelemetryName})}),this.reportDialogPrivacyStatementLinkTelemetryObject=a.addOrUpdateChild({name:n.reportDialogPrivacyStatementTelemetryName,behavior:s.b.Navigate,content:Object.assign(Object.assign({},t),{headline:n.reportDialogPrivacyStatementTelemetryName})})}setTelemetryObjectContract(e,t,i){return e.contract&&(e.contract.content.id=t,e.contract.content.type=s.c.Article,e.contract.destinationUrl=i||""),e}}},y4Tj:function(e,t){},zZnt:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return o}));var s=i("Cj5D"),n=i("dTwT");const a={bingShoppingVisible:!0,moneyVisible:!0,sportsVisible:!0,weatherVisible:!0,horoscopeVisible:!0,onThisDayVisible:!0,electionsVisible:!0},r="localCardState";function o(e,t){switch(e){case s.a.edgePageSettings:{const e=t,i=e?e.getCurrentState():void 0;return{weatherVisible:!(!i||!i.weatherVisible),sportsVisible:!(!i||!i.sportsVisible),moneyVisible:!(!i||!i.moneyVisible),bingShoppingVisible:!(!i||!i.bingShoppingVisible),horoscopeVisible:!(!i||!i.horoscopeVisible),onThisDayVisible:!(!i||!i.onThisDayVisible),electionsVisible:!(!i||!i.electionsVisible)}}case s.a.chromiumPageSettings:{const e=t,i=e?e.getCurrentState():void 0;return{weatherVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.weatherVisible),sportsVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.sportsVisible),moneyVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.moneyVisible),bingShoppingVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.bingShoppingVisible),horoscopeVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.horoscopeVisible),onThisDayVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.onThisDayVisible),electionsVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.electionsVisible)}}case s.a.localStorageSettings:return Object(n.a)().supported?Object(n.a)().getObject(r,a):a;default:return}}}}]);